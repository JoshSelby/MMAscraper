fightsEloLong %>% View
fightsEloLong %>% filter(Link == "Mitsuo-Fujikura-10600")
rankelo %>% head
rankelo$player %>% head
write_csv(fightsEloLong %>%
filter(Link %in% (rankelo$player %>% head(20))) %>%
arrange(Date), "d3/fightsEloLong3.csv")
fights$>$ head(1)
fights %>% head(1)
write_csv(fightsEloLong %>%
filter(Date > "2017-01-01") %>%
arrange(Date), "d3/fightsEloLong3.csv")
rankelo
rankelo %>% View
readRDS(file = "~/GitHub/MMAscraper/raw-data-1/fights_table.rds")
fights_list <- readRDS(file = "~/GitHub/MMAscraper/raw-data-1/fights_table.rds")
fights <- fights_list$fights
rm(fights_list)
fights %>% class()
library(tidyverse)
library(tidyverse)
fights <- fights_list$fights
fights %>% class
fights %>% arrange(Date) %>% head
fights %>% arrange(-Date) %>% head
fights %>% arrange(Date) %>% tail
fights %>% arrange(Date) %>% View
library(rvest)
fights_page <- tryCatch({
fights_page <-read_html("http://www.sherdog.com/")
fights_page <-read_html("http://www.sherdog.com/")
fights_page
fights_page[1]
fights_page[2]
fights_page
fights_page <-read_html("http://www.sherdog.com/events/")
fights_page
fights_page[1]
fights_page %>% html_text
html_nodes(fights_page, "id")
html_nodes(fights_page, "id=recentfights_tab")
html_nodes(fights_page, "id:recentfights_tab")
html_nodes(fights_page, "tab_menu")
html_nodes(fights_page, "class:tab_menu")
html_nodes(fights_page, "td")
html_nodes(fights_page, "td") %>% html_text()
html_nodes(fights_page, "#recentfights_tab") %>% html_text()
html_nodes(fights_page, "#recentfights_tab")
html_nodes(fights_page, "#recentfights_tab") %>% html_text()
html_nodes(fights_page, "#recentfights_tab") %>% html_text()
html_nodes(fights_page, "#recentfights_tab td") %>% html_text()
html_nodes(fights_page, "#recentfights_tab td") %>% html_text()
event_Dates <- html_nodes(fights_page, "#recentfights_tab td") %>% html_text()
event_Dates
event_Dates <- html_nodes(fights_page, "#recentfights_tab td:nth-child(2) a") %>% html_text()
event_Dates
event_Dates <- html_nodes(fights_page, "#recentfights_tab td:nth-child(1) a") %>% html_text()
event_Dates
event_Dates <- html_nodes(fights_page, "#recentfights_tab td:nth-child(1)") %>% html_text()
event_Dates
event_Dates %>% head
gsub("\n|\t", "", event_Dates)
gsub("\n|\t", "", event_Dates) %>% trim()
gsub("\n|\t", "", event_Dates) %>% trimws()
event_Dates <- html_nodes(fights_page, "#recentfights_tab td:nth-child(1) a") %>%
html_text() %>%
gsub("\n|\t", "",.) %>%
trimws()
event_Dates
event_Dates <- html_nodes(fights_page, "#recentfights_tab td:nth-child(1) a") %>%
html_text() %>%
gsub("\n|\t", "",.) %>%
trimws()
event_Dates <- html_nodes(fights_page, "#recentfights_tab td:nth-child(1)") %>%
html_text() %>%
gsub("\n|\t", "",.) %>%
trimws()
event_Names <- html_nodes(fights_page, "#recentfights_tab td:nth-child(2)") %>%
html_text()
event_Names
html_nodes(fights_page, "#recentfights_tab td:nth-child(3)") %>%
html_text()
event_Names <- html_nodes(fights_page, "#recentfights_tab td:nth-child(2)") %>%
html_text() %>%
paste0(, "-",
html_nodes(fights_page, "#recentfights_tab td:nth-child(3)") %>%
html_text())
?paste0
event_Names <- html_nodes(fights_page, "#recentfights_tab td:nth-child(2)") %>%
html_text() %>%
paste0(html_nodes(fights_page, "#recentfights_tab td:nth-child(3)") %>%
html_text(),
sep = "-",)
event_Names <- html_nodes(fights_page, "#recentfights_tab td:nth-child(2)") %>%
html_text() %>%
paste(html_nodes(fights_page, "#recentfights_tab td:nth-child(3)") %>%
html_text(),
sep = "-",)
event_Names <- html_nodes(fights_page, "#recentfights_tab td:nth-child(2)") %>%
html_text() %>%
paste(html_nodes(fights_page, "#recentfights_tab td:nth-child(3)") %>%
html_text(),
sep = "-")
event_Names
event_Names <- html_nodes(fights_page, "#recentfights_tab td:nth-child(2)") %>%
html_text() %>%
paste0(html_nodes(fights_page, "#recentfights_tab td:nth-child(3)") %>%
html_text(),
sep = "-")
event_Names
event_Names <- html_nodes(fights_page, "#recentfights_tab td:nth-child(2)") %>%
html_text() %>%
paste(html_nodes(fights_page, "#recentfights_tab td:nth-child(3)") %>%
html_text(),
sep = " - ")
event_Names
event_Names <- fights_page %>%
html_nodes("#recentfights_tab td:nth-child(2)") %>%
paste(fights_page %>%
html_nodes("#recentfights_tab td:nth-child(3)"),
sep = " - ")
event_Names
event_Dates <- fights_page %>%
html_nodes("#recentfights_tab td:nth-child(1)") %>%
html_text() %>%
gsub("\n|\t", "",.) %>%
trimws()
event_Dates
fights_page %>%
html_nodes("#recentfights_tab td:nth-child(2)")
event_Names <- fights_page %>%
html_nodes("#recentfights_tab td:nth-child(2)") %>%
html_text()
event_Names
event_Names <- fights_page %>%
html_nodes("#recentfights_tab td:nth-child(2)") %>%
html_text() %>%
paste(fights_page %>%
html_nodes("#recentfights_tab td:nth-child(2)"),
sep = " - ")
event_Names
event_Names <- fights_page %>%
html_nodes("#recentfights_tab td:nth-child(2)") %>%
html_text() %>%
paste(fights_page %>%
html_nodes("#recentfights_tab td:nth-child(2)") %>%
html_text(),
sep = " - ")
event_Names
event_Names <- fights_page %>%
html_nodes("#recentfights_tab td:nth-child(2)") %>%
html_text() %>%
paste(fights_page %>%
html_nodes("#recentfights_tab td:nth-child(3)") %>%
html_text(),
sep = " - ")
event_Names
event_Links <- fights_page %>%
html_nodes("#recentfights_tab td:nth-child(4)") %>%
html_text()
event_Links
event_Links <- fights_page %>%
html_nodes("#recentfights_tab td:nth-child(5)") %>%
html_text()
event_Links
event_Links <- fights_page %>%
html_nodes("#recentfights_tab td:nth-child(4)") %>%
html_attr()
event_Links <- fights_page %>%
html_nodes("#recentfights_tab td:nth-child(3)") %>%
html_attr()
event_Links <- fights_page %>%
html_nodes("#recentfights_tab td:nth-child(3)") %>%
html_attr("href")
event_Links
fights_page %>%
html_nodes("#recentfights_tab td:nth-child(3)")
fights_page %>%
html_nodes("#recentfights_tab td:nth-child(3) a")
fights_page %>%
html_nodes("#recentfights_tab td:nth-child(3) a") %>% html_attr("href")
event_Links <- fights_page %>%
html_nodes("#recentfights_tab td:nth-child(2) a") %>%
html_attr("href")
event_Links
event_Links <- fights_page %>%
html_nodes("#recentfights_tab td:nth-child(2) a") %>%
html_attr("href") %>%
c("Links", .)
event_Table <- cbind(event_Dates, event_Names, event_Links)
event_Table
View(event_Table)
event_Table %>% class()
event_Table <- cbind(event_Dates, event_Names, event_Links)
event_Table %>% as.tibble
?as.tibble
event_Table %>% as.tibble(header=T)
as.Date(c("2007-06-22", "2004-02-13"))
Sys.Date()
1:5 %>% shift
?Shift
shift
eventDates[-1]
event_Dates[-1]
event_Dates <- fights_page %>%
html_nodes("#recentfights_tab td:nth-child(1)") %>%
html_text() %>%
gsub("\n|\t", "",.) %>%
trimws() %>%
.[-1]
event_Dates
event_Links <- fights_page %>%
html_nodes("#recentfights_tab td:nth-child(2) a") %>%
html_attr("href")
.[-1]
event_Names <- fights_page %>%
html_nodes("#recentfights_tab td:nth-child(2)") %>%
html_text() %>%
paste(fights_page %>%
html_nodes("#recentfights_tab td:nth-child(3)") %>%
html_text(),
sep = " - ") %>%
.[-1]
event_Table <- cbind(event_Dates, event_Names, event_Links)
event_Table <- cbind(event_Dates, event_Names, event_Links) %>% as.tibble()
event_tbl <- cbind(event_Dates, event_Names, event_Links) %>% as.tibble()
rm(event_Table)
View(event_tbl)
format(event_Dates, format="%B %d %Y")
Sys.Date()
as.Date(event_Dates,
format = "%B %d %Y")
event_Dates <- fights_page %>%
html_nodes("#recentfights_tab td:nth-child(1)") %>%
html_text() %>%
gsub("\n|\t", "",.) %>%
trimws() %>%
.[-1] %>%
as.Date(format = "%B %d %Y")
event_tbl <- cbind(event_Dates, event_Names, event_Links) %>% as.tibble()
View(event_tbl)
event_Dates
event_tbl <- tibble(Dates = event_Dates)
event_tbl <- tibble(Dates = event_Dates, Links = event_Links)
event_tbl <- tibble(Dates = event_Dates, Names = event_Names, Links = event_Links)
View(event_tbl)
fights %>% arrange(Date) %>% tail
fights %>% arrange(Date) %>% select(Date) %>% tail
fights %>% arrange(Date) %>% select(Date) %>% tail(1)
lastDate <- fights %>% arrange(Date) %>% select(Date) %>% tail()
lastDate <- fights %>% arrange(Date) %>% pull(Date) %>% tail(1)
tail(event_Dates)
tail(event_Dates, 1)
tail(event_Dates, 1) > lastDate
tail(event_Dates, 1) >= lastDate
read_html(paste0("http://www.sherdog.com/events/recent/",2,"-page"))
paste0("http://www.sherdog.com/events/recent/",2,"-page")
while (tail(event_Dates, 1) > lastDate) {
fights_pagei <- read_html(paste0("http://www.sherdog.com/events/recent/",i,"-page"))
}
i = 2
fights_pagei <- read_html(paste0("http://www.sherdog.com/events/recent/",i,"-page"))
fights_pagei %>%
html_nodes("#recentfights_tab td:nth-child(1)") %>%
html_text() %>%
gsub("\n|\t", "",.) %>%
trimws() %>%
.[-1] %>%
as.Date(format = "%B %d %Y")
event_Dates <- event_Dates %>%
c(fights_pagei %>%
html_nodes("#recentfights_tab td:nth-child(1)") %>%
html_text() %>%
gsub("\n|\t", "",.) %>%
trimws() %>%
.[-1] %>%
as.Date(format = "%B %d %Y"))
tail(event_Dates, 1) > lastDate
recEvents <- function(events) {
event_Dates <- events %>%
html_nodes("#recentfights_tab td:nth-child(1)") %>%
html_text() %>%
gsub("\n|\t", "",.) %>%
trimws() %>%
.[-1] %>%
as.Date(format = "%B %d %Y")
event_Names <- events %>%
html_nodes("#recentfights_tab td:nth-child(2)") %>%
html_text() %>%
paste(events %>%
html_nodes("#recentfights_tab td:nth-child(3)") %>%
html_text(),
sep = " - ") %>%
.[-1]
event_Links <- events %>%
html_nodes("#recentfights_tab td:nth-child(2) a") %>%
html_attr("href")
}
library(tidyverse)
library(rvest)
# Get all fights you already scraped
fights_list <- readRDS(file = "~/GitHub/MMAscraper/raw-data-1/fights_table.rds")
fights <- fights_list$fights
rm(fights_list)
# What's the most recent Date you have already scraped
lastDate <- fights %>%
arrange(Date) %>%
pull(Date) %>%
tail(1)
fights_page <- read_html("http://www.sherdog.com/events/")
recEvents <- function(events) {
event_Dates <- events %>%
html_nodes("#recentfights_tab td:nth-child(1)") %>%
html_text() %>%
gsub("\n|\t", "",.) %>%
trimws() %>%
.[-1] %>%
as.Date(format = "%B %d %Y")
event_Names <- events %>%
html_nodes("#recentfights_tab td:nth-child(2)") %>%
html_text() %>%
paste(events %>%
html_nodes("#recentfights_tab td:nth-child(3)") %>%
html_text(),
sep = " - ") %>%
.[-1]
event_Links <- events %>%
html_nodes("#recentfights_tab td:nth-child(2) a") %>%
html_attr("href")
}
recEvents(fights_page)
recEvents(fights_page)
.Last.value
recEvents <- function(events) {
event_Dates <- events %>%
html_nodes("#recentfights_tab td:nth-child(1)") %>%
html_text() %>%
gsub("\n|\t", "",.) %>%
trimws() %>%
.[-1] %>%
as.Date(format = "%B %d %Y")
event_Names <- events %>%
html_nodes("#recentfights_tab td:nth-child(2)") %>%
html_text() %>%
paste(events %>%
html_nodes("#recentfights_tab td:nth-child(3)") %>%
html_text(),
sep = " - ") %>%
.[-1]
event_Links <- events %>%
html_nodes("#recentfights_tab td:nth-child(2) a") %>%
html_attr("href")
return(tibble(Dates = event_Dates, Names = event_Names, Links = event_Links))
}
recEvents(fights_page)
event_tbl <- recEvents(fights_page)
i = 2
while (tail(event_Dates, 1) > lastDate) {
fights_pagei <- read_html(paste0("http://www.sherdog.com/events/recent/",i,"-page"))
recEvents(fights_page)
i = i+1
}
event_tbl
tail(event_tbl %>% pull(Dates))
tail(event_tbl %>% pull(Dates), 1)
i = 2
fights_pagei <- read_html(paste0("http://www.sherdog.com/events/recent/",i,"-page"))
recEvents(fights_page)
recEvents(fights_pagei)
event_tbl <- rbind(event_tbl, recEvents(fights_pagei))
i = 2
while (tail(event_tbl %>% pull(Dates), 1) > lastDate) {
fights_pagei <- read_html(paste0("http://www.sherdog.com/events/recent/",i,"-page"))
event_tbl <- rbind(event_tbl, recEvents(fights_pagei))
i = i+1
}
library(tidyverse)
library(rvest)
# Get all fights you already scraped
fights_list <- readRDS(file = "~/GitHub/MMAscraper/raw-data-1/fights_table.rds")
fights <- fights_list$fights
rm(fights_list)
# What's the most recent Date you have already scraped
lastDate <- fights %>%
arrange(Date) %>%
pull(Date) %>%
tail(1)
fights_page <- read_html("http://www.sherdog.com/events/")
recEvents <- function(events) {
event_Dates <- events %>%
html_nodes("#recentfights_tab td:nth-child(1)") %>%
html_text() %>%
gsub("\n|\t", "",.) %>%
trimws() %>%
.[-1] %>%
as.Date(format = "%B %d %Y")
event_Names <- events %>%
html_nodes("#recentfights_tab td:nth-child(2)") %>%
html_text() %>%
paste(events %>%
html_nodes("#recentfights_tab td:nth-child(3)") %>%
html_text(),
sep = " - ") %>%
.[-1]
event_Links <- events %>%
html_nodes("#recentfights_tab td:nth-child(2) a") %>%
html_attr("href")
return(tibble(Dates = event_Dates, Names = event_Names, Links = event_Links))
}
event_tbl <- recEvents(fights_page)
i = 2
while (tail(event_tbl %>% pull(Dates), 1) > lastDate) {
fights_pagei <- read_html(paste0("http://www.sherdog.com/events/recent/",i,"-page"))
event_tbl <- rbind(event_tbl, recEvents(fights_pagei))
i = i+1
}
event_tbl <- event_tbl %>%
filter(Date > lastDate)
event_tbl <- event_tbl %>%
select(Date > lastDate)
event_tbl <- event_tbl %>%
select(Dates > lastDate)
event_tbl <- event_tbl %>%
filter(Dates > lastDate)
source('~/GitHub/MMAscraper/update-scraper.R', echo=TRUE)
event_tbl$Links
read_html(paste0("http://www.sherdog.com", event_tbl$Links[1]))
event <- read_html(paste0("http://www.sherdog.com", event_tbl$Links[1]))
event %>% html_nodes("td") %>% html_text()
event %>% html_nodes("td:nth-child(1)") %>% html_text()
event %>% html_nodes("td:nth-child(1) a") %>% html_text()
event %>% html_nodes("td:nth-child(2) a") %>% html_text()
event %>% html_nodes("td:nth-child(2)") %>% html_text()
event %>% html_nodes("td:nth-child(2) a") %>% html_text()
event_tbl$Links[1]
event %>% html_nodes("td:nth-child(2) a") %>% html_text()
rm(event_page, events_pagei, i)
rm(events_page, events_pagei, i)
event %>% html_nodes("td:nth-child(2) a") %>% html_text()
Fighter1 <- event %>% html_nodes("td:nth-child(2) a") %>% html_text()
Fighter2 <- event %>% html_nodes("td:nth-child(3) a") %>% html_text()
Fighter2
event %>% html_nodes("td:nth-child(3) a") %>% html_text()
event %>% html_nodes("td:nth-child(3)") %>% html_text()
event %>% html_nodes("td:nth-child(4)") %>% html_text()
event %>% html_nodes("td:nth-child(4) a") %>% html_text()
Fighter2 <- event %>% html_nodes("td:nth-child(4) a") %>% html_text()
event <- read_html(paste0("http://www.sherdog.com", event_tbl$Links[162]))
event_tbl$Links[162]
event <- read_html(paste0("http://www.sherdog.com", event_tbl$Links[1]))
Fighter1 <- event %>% html_nodes("td:nth-child(2) a") %>% html_text()
Fighter2 <- event %>% html_nodes("td:nth-child(4) a") %>% html_text()
event %>% html_nodes("td:nth-child(3) a") %>% html_text()
event %>% html_nodes("td:nth-child(3)") %>% html_text()
event %>% html_nodes(".yet_to_come") %>% html_text()
event %>% html_nodes(".yet_to_come")
View(event_tbl)
event <- read_html(paste0("http://www.sherdog.com", event_tbl$Links[30]))
Fighter1 <- event %>% html_nodes("td:nth-child(2) a") %>% html_text()
Fighter2 <- event %>% html_nodes("td:nth-child(4) a") %>% html_text()
event %>% html_nodes(".yet_to_come")
event %>% html_nodes(".yet_to_come") %>% html_text()
isNull <- event %>% html_nodes(".yet_to_come") %>% html_text()
is.null(isNull)
identical(isNull, character(0))
if (identical(noRecords, character(0)), next)
identical(noRecords, character(0)
)
noRecords <- event %>% html_nodes(".yet_to_come") %>% html_text()
identical(noRecords, character(0))
event <- read_html(paste0("http://www.sherdog.com", event_tbl$Links[30]))
noRecords <- event %>% html_nodes(".yet_to_come") %>% html_text()
identical(noRecords, character(0))
noRecords
!identical(noRecords, character(0))
event <- read_html(paste0("http://www.sherdog.com", event_tbl$Links[1]))
noRecords <- event %>% html_nodes(".yet_to_come") %>% html_text()
noRecords
event <- read_html(paste0("http://www.sherdog.com", event_tbl$Links[30]))
noRecords <- event %>% html_nodes(".yet_to_come") %>% html_text()
Fighter1 <- event %>% html_nodes("td:nth-child(2) a") %>% html_text()
Fighter2 <- event %>% html_nodes("td:nth-child(4) a") %>% html_text()
FIghter1
Fighter1
event %>% html_nodes("td:nth-child(3) a") %>% html_text()
event %>% html_nodes("td:nth-child(3)") %>% html_text()
event %>% html_nodes("td:nth-child(5)") %>% html_text()
event %>% html_nodes("td:nth-child(6)") %>% html_text()
event %>% html_nodes("td:nth-child(7)") %>% html_text()
event %>% html_nodes("td:nth-child(8)") %>% html_text()
event %>% html_nodes("td:nth-child(7)") %>% html_text()
event %>% html_nodes("td:nth-child(7) a") %>% html_text()
event %>% html_nodes("td:nth-child(7)") %>% html_text()
event %>% html_nodes("td") %>% html_text()
event %>% html_nodes("td:final_result") %>% html_text()
event %>% html_nodes("final_result") %>% html_text()
event %>% html_nodes("td:.win") %>% html_text()
event %>% html_nodes(".win") %>% html_text()
event %>% html_nodes("td") %>% html_text()
event %>% html_nodes("td") %>% html_text() %>% html_text
event %>% html_nodes("td") %>% html_text() %>% html_text()
event %>% html_nodes("td") %>% html_text() %>% matrix(ncol = 6, byrow = T)
event %>% html_nodes("td") %>% html_text() %>% matrix(ncol = 7, byrow = T)
event %>% html_nodes("td") %>% html_text() %>% matrix(ncol = 8, byrow = T)
event %>% html_nodes("td") %>% html_text() %>% matrix(ncol = 5, byrow = T)
event %>% html_nodes("td") %>% html_text()
event %>% html_nodes("a") %>% html_text()
event %>% html_nodes("h2") %>% html_text()
event %>% html_nodes("h3") %>% html_text()
event %>% html_nodes("h4") %>% html_text()
event %>% html_nodes(div) %>% html_text()
event %>% html_nodes("div") %>% html_text()
