oddsCheck = paste0("between(odds, ",per_to_line(winper+0.05) %>% round(0),", ",
per_to_line(winper-0.05) %>% round(0),")"),
ageCheck = paste0("between(Age1-Age2, ",round(Age1-Age2-2, 1),", ", round(Age1-Age2+2, 1),")"),
ratCheck = paste0("between(r1b-r2b, ",round(r1b-r2b-50, 0),", ", round(r1b-r2b+50, 0),")")) %>%
do(mutate(
ROI = filtData %>%
filter(paste(c(oddsCheck, ageCheck, ratCheck), collapse = " & ")) %>%
summarise(avgWin = sum(winnings)/n(),
wins = sum(Result=="win"),
count = n(),
winPer = paste0(round(wins/count * 100,2),"%"),
bet = mean(bet),
ROI = paste0(round(sum(winnings)/(bet*n())*100, 2), "%")) %>%
pull(ROI)
)
) %>%
View()
filtfightsOdds %>%
slice(1) %>%
rowwise() %>%
mutate(winper = line_to_per(odds),
oddsCheck = paste0("between(odds, ",per_to_line(winper+0.05) %>% round(0),", ",
per_to_line(winper-0.05) %>% round(0),")"),
ageCheck = paste0("between(Age1-Age2, ",round(Age1-Age2-2, 1),", ", round(Age1-Age2+2, 1),")"),
ratCheck = paste0("between(r1b-r2b, ",round(r1b-r2b-50, 0),", ", round(r1b-r2b+50, 0),")"),
ROI = filtData %>%
filter(paste(c(oddsCheck, ageCheck, ratCheck), collapse = " & ")) %>%
summarise(avgWin = sum(winnings)/n(),
wins = sum(Result=="win"),
count = n(),
winPer = paste0(round(wins/count * 100,2),"%"),
bet = mean(bet),
ROI = paste0(round(sum(winnings)/(bet*n())*100, 2), "%")) %>%
pull(ROI)
) %>%
View()
filtfightsOdds %>%
slice(1) %>%
rowwise() %>%
mutate(winper = line_to_per(odds),
oddsCheck = paste0("between(odds, ",per_to_line(winper+0.05) %>% round(0),", ",
per_to_line(winper-0.05) %>% round(0),")"),
ageCheck = paste0("between(Age1-Age2, ",round(Age1-Age2-2, 1),", ", round(Age1-Age2+2, 1),")"),
ratCheck = paste0("between(r1b-r2b, ",round(r1b-r2b-50, 0),", ", round(r1b-r2b+50, 0),")"),
ROI = paste(c(oddsCheck, ageCheck, ratCheck), collapse = " & ")
) %>%
View()
filtfightsOdds %>%
slice(1) %>%
rowwise() %>%
mutate(winper = line_to_per(odds),
oddsCheck = paste0("between(odds, ",per_to_line(winper+0.05) %>% round(0),", ",
per_to_line(winper-0.05) %>% round(0),")"),
ageCheck = paste0("between(Age1-Age2, ",round(Age1-Age2-2, 1),", ", round(Age1-Age2+2, 1),")"),
ratCheck = paste0("between(r1b-r2b, ",round(r1b-r2b-50, 0),", ", round(r1b-r2b+50, 0),")"),
ROI = filtData %>%
filter(expr(paste(c(oddsCheck, ageCheck, ratCheck), collapse = " & "))) %>%
summarise(avgWin = sum(winnings)/n(),
wins = sum(Result=="win"),
count = n(),
winPer = paste0(round(wins/count * 100,2),"%"),
bet = mean(bet),
ROI = paste0(round(sum(winnings)/(bet*n())*100, 2), "%")) %>%
pull(ROI)
) %>%
View()
expr(paste(c(oddsCheck, ageCheck, ratCheck), collapse = " & "))
?expr
filtfightsOdds %>%
slice(1) %>%
rowwise() %>%
mutate(winper = line_to_per(odds),
oddsCheck = paste0("between(odds, ",per_to_line(winper+0.05) %>% round(0),", ",
per_to_line(winper-0.05) %>% round(0),")"),
ageCheck = paste0("between(Age1-Age2, ",round(Age1-Age2-2, 1),", ", round(Age1-Age2+2, 1),")"),
ratCheck = paste0("between(r1b-r2b, ",round(r1b-r2b-50, 0),", ", round(r1b-r2b+50, 0),")"),
ROI = filtData %>%
filter(eval(parse(paste(c(oddsCheck, ageCheck, ratCheck), collapse = " & ")))) %>%
summarise(avgWin = sum(winnings)/n(),
wins = sum(Result=="win"),
count = n(),
winPer = paste0(round(wins/count * 100,2),"%"),
bet = mean(bet),
ROI = paste0(round(sum(winnings)/(bet*n())*100, 2), "%")) %>%
pull(ROI)
) %>%
View()
filtfightsOdds %>%
slice(1) %>%
rowwise() %>%
mutate(winper = line_to_per(odds),
oddsCheck = paste0("between(odds, ",per_to_line(winper+0.05) %>% round(0),", ",
per_to_line(winper-0.05) %>% round(0),")"),
ageCheck = paste0("between(Age1-Age2, ",round(Age1-Age2-2, 1),", ", round(Age1-Age2+2, 1),")"),
ratCheck = paste0("between(r1b-r2b, ",round(r1b-r2b-50, 0),", ", round(r1b-r2b+50, 0),")"),
ROI = filtData %>%
filter(eval(parse(text=paste(c(oddsCheck, ageCheck, ratCheck), collapse = " & ")))) %>%
summarise(avgWin = sum(winnings)/n(),
wins = sum(Result=="win"),
count = n(),
winPer = paste0(round(wins/count * 100,2),"%"),
bet = mean(bet),
ROI = paste0(round(sum(winnings)/(bet*n())*100, 2), "%")) %>%
pull(ROI)
) %>%
View()
filtData %>%
filter(between(odds, -179, -118) &
between(Age1-Age2, 0.9, 4.9) &
between(r1b-r2b, -179, -79)
) %>%
summarise(avgWin = sum(winnings)/n(),
wins = sum(Result=="win"),
count = n(),
winPer = paste0(round(wins/count * 100,2),"%"),
bet = mean(bet),
ROI = paste0(round(sum(winnings)/(bet*n())*100, 2), "%")) %>%
pull(ROI)
filtfightsOdds %>%
slice(1) %>%
rowwise() %>%
mutate(winper = line_to_per(odds),
oddsCheck = paste0("between(odds, ",per_to_line(winper+0.05) %>% round(0),", ",
per_to_line(winper-0.05) %>% round(0),")"),
ageCheck = paste0("between(Age1-Age2, ",round(Age1-Age2-2, 1),", ", round(Age1-Age2+2, 1),")"),
ratCheck = paste0("between(r1b-r2b, ",round(r1b-r2b-50, 0),", ", round(r1b-r2b+50, 0),")"),
datCheck = paste0("Date < ", Date),
ROI = filtData %>%
filter(eval(parse(text=paste(c(oddsCheck, ageCheck, ratCheck), collapse = " & ")))) %>%
summarise(avgWin = sum(winnings)/n(),
wins = sum(Result=="win"),
count = n(),
winPer = paste0(round(wins/count * 100,2),"%"),
bet = mean(bet),
ROI = paste0(round(sum(winnings)/(bet*n())*100, 2), "%")) %>%
pull(ROI)
) %>%
View()
filtfightsOdds %>%
slice(1) %>%
rowwise() %>%
mutate(winper = line_to_per(odds),
oddsCheck = paste0("between(odds, ",per_to_line(winper+0.05) %>% round(0),", ",
per_to_line(winper-0.05) %>% round(0),")"),
ageCheck = paste0("between(Age1-Age2, ",round(Age1-Age2-2, 1),", ", round(Age1-Age2+2, 1),")"),
ratCheck = paste0("between(r1b-r2b, ",round(r1b-r2b-50, 0),", ", round(r1b-r2b+50, 0),")"),
datCheck = paste0("Date < ", Date),
ROI = filtData %>%
filter(eval(parse(text=paste(c(oddsCheck, ageCheck, ratCheck, datCheck), collapse = " & ")))) %>%
summarise(avgWin = sum(winnings)/n(),
wins = sum(Result=="win"),
count = n(),
winPer = paste0(round(wins/count * 100,2),"%"),
bet = mean(bet),
ROI = paste0(round(sum(winnings)/(bet*n())*100, 2), "%")) %>%
pull(ROI)
) %>%
View()
filtfightsOdds %>%
slice(1:100) %>%
rowwise() %>%
mutate(winper = line_to_per(odds),
oddsCheck = paste0("between(odds, ",per_to_line(winper+0.05) %>% round(0),", ",
per_to_line(winper-0.05) %>% round(0),")"),
ageCheck = paste0("between(Age1-Age2, ",round(Age1-Age2-2, 1),", ", round(Age1-Age2+2, 1),")"),
ratCheck = paste0("between(r1b-r2b, ",round(r1b-r2b-50, 0),", ", round(r1b-r2b+50, 0),")"),
datCheck = paste0("Date < ", Date),
ROI = filtData %>%
filter(eval(parse(text=paste(c(oddsCheck, ageCheck, ratCheck, datCheck), collapse = " & ")))) %>%
summarise(avgWin = sum(winnings)/n(),
wins = sum(Result=="win"),
count = n(),
winPer = paste0(round(wins/count * 100,2),"%"),
bet = mean(bet),
ROI = paste0(round(sum(winnings)/(bet*n())*100, 2), "%")) %>%
pull(ROI)
) %>%
View()
test <- filtfightsOdds %>%
slice(1:100) %>%
rowwise() %>%
mutate(winper = line_to_per(odds),
oddsCheck = paste0("between(odds, ",per_to_line(winper+0.05) %>% round(0),", ",
per_to_line(winper-0.05) %>% round(0),")"),
ageCheck = paste0("between(Age1-Age2, ",round(Age1-Age2-2, 1),", ", round(Age1-Age2+2, 1),")"),
ratCheck = paste0("between(r1b-r2b, ",round(r1b-r2b-50, 0),", ", round(r1b-r2b+50, 0),")"),
datCheck = paste0("Date < ", Date)
)
test
for (i in 1:100) {}
test <- filtfightsOdds %>%
slice(1:100) %>%
rowwise() %>%
mutate(winper = line_to_per(odds),
oddsCheck = paste0("between(odds, ",per_to_line(winper+0.05) %>% round(0),", ",
per_to_line(winper-0.05) %>% round(0),")"),
ageCheck = paste0("between(Age1-Age2, ",round(Age1-Age2-2, 1),", ", round(Age1-Age2+2, 1),")"),
ratCheck = paste0("between(r1b-r2b, ",round(r1b-r2b-50, 0),", ", round(r1b-r2b+50, 0),")"),
datCheck = paste0("Date < ", Date),
ROI = NULL
)
test <- filtfightsOdds %>%
slice(1:100) %>%
rowwise() %>%
mutate(winper = line_to_per(odds),
oddsCheck = paste0("between(odds, ",per_to_line(winper+0.05) %>% round(0),", ",
per_to_line(winper-0.05) %>% round(0),")"),
ageCheck = paste0("between(Age1-Age2, ",round(Age1-Age2-2, 1),", ", round(Age1-Age2+2, 1),")"),
ratCheck = paste0("between(r1b-r2b, ",round(r1b-r2b-50, 0),", ", round(r1b-r2b+50, 0),")"),
datCheck = paste0("Date < ", Date),
ROI = NULL
)
test <- filtfightsOdds %>%
slice(1:100) %>%
rowwise() %>%
mutate(winper = line_to_per(odds),
oddsCheck = paste0("between(odds, ",per_to_line(winper+0.05) %>% round(0),", ",
per_to_line(winper-0.05) %>% round(0),")"),
ageCheck = paste0("between(Age1-Age2, ",round(Age1-Age2-2, 1),", ", round(Age1-Age2+2, 1),")"),
ratCheck = paste0("between(r1b-r2b, ",round(r1b-r2b-50, 0),", ", round(r1b-r2b+50, 0),")"),
datCheck = paste0("Date < ", Date),
ROI = NA
)
c(test$ageCheck[i], test$datCheck[i], test$ratCheck[i], test$datCheck[i])
test$ROI[i] <- filtData %>%
filter(paste(c(test$oddsCheck[i], test$ageCheck[i], test$ratCheck[i], test$datCheck[i]))) %>%
summarise(avgWin = sum(winnings)/n(),
wins = sum(Result=="win"),
count = n(),
winPer = paste0(round(wins/count * 100,2),"%"),
bet = mean(bet),
ROI = paste0(round(sum(winnings)/(bet*n())*100, 2), "%")) %>%
pull(ROI)
c(test$oddsCheck[i], test$ageCheck[i], test$ratCheck[i], test$datCheck[i])
test[i, 57:60]
test[i, 57:60] %>% as.character
paste(test[i, 57:60] %>% as.character, collapse=" & ")
test$ROI[i] <- filtData %>%
filter(expr(parse(text=paste(test[i, 57:60] %>% as.character, collapse=" & ")))) %>%
summarise(avgWin = sum(winnings)/n(),
wins = sum(Result=="win"),
count = n(),
winPer = paste0(round(wins/count * 100,2),"%"),
bet = mean(bet),
ROI = paste0(round(sum(winnings)/(bet*n())*100, 2), "%")) %>%
pull(ROI)
i=1
filtData %>%
filter(expr(parse(text=paste(test[i, 57:60] %>% as.character, collapse=" & "))))
expr(parse(text=paste(test[i, 57:60] %>% as.character, collapse=" & ")))
parse(text=paste(test[i, 57:60] %>% as.character, collapse=" & "))
filtData %>%
filter(test[i, 57:60] %>% as.character, collapse=" & ")
filtData %>%
filter(paste(test[i, 57:60] %>% as.character, collapse=" & "))
paste(test[i, 57:60] %>% as.character, collapse=" & ")
filtData %>%
filter(between(odds, -179, -118) & between(Age1-Age2, 0.9, 4.9) & between(r1b-r2b, -179, -79) & Date < 2007-11-16)
filtData %>%
filter("between(odds, -179, -118) & between(Age1-Age2, 0.9, 4.9) & between(r1b-r2b, -179, -79) & Date < 2007-11-16")
filtData %>%
filter(expr("between(odds, -179, -118) & between(Age1-Age2, 0.9, 4.9) & between(r1b-r2b, -179, -79) & Date < 2007-11-16"))
expr("between(odds, -179, -118) & between(Age1-Age2, 0.9, 4.9) & between(r1b-r2b, -179, -79) & Date < 2007-11-16")
parse("between(odds, -179, -118) & between(Age1-Age2, 0.9, 4.9) & between(r1b-r2b, -179, -79) & Date < 2007-11-16")
parse(text="between(odds, -179, -118) & between(Age1-Age2, 0.9, 4.9) & between(r1b-r2b, -179, -79) & Date < 2007-11-16")
expr(parse(text="between(odds, -179, -118) & between(Age1-Age2, 0.9, 4.9) & between(r1b-r2b, -179, -79) & Date < 2007-11-16"))
parse(text="between(odds, -179, -118) & between(Age1-Age2, 0.9, 4.9) & between(r1b-r2b, -179, -79) & Date < 2007-11-16")
filtData %>%
filter(parse(text="between(odds, -179, -118) & between(Age1-Age2, 0.9, 4.9) & between(r1b-r2b, -179, -79) & Date < 2007-11-16"))
library(rlang)
filtData %>%
filter(parse_expr(text="between(odds, -179, -118) & between(Age1-Age2, 0.9, 4.9) & between(r1b-r2b, -179, -79) & Date < 2007-11-16"))
filtData %>%
filter(parse_expr("between(odds, -179, -118) & between(Age1-Age2, 0.9, 4.9) & between(r1b-r2b, -179, -79) & Date < 2007-11-16"))
parse_expr("between(odds, -179, -118) & between(Age1-Age2, 0.9, 4.9) & between(r1b-r2b, -179, -79) & Date < 2007-11-16")
?parse_expr
filtData %>% filter(Data >"2007-01-01")
filtData %>% filter(Date >"2007-01-01")
filtData %>% filter(Date >2007-01-01)
test <- filtfightsOdds %>%
slice(1:100) %>%
rowwise() %>%
mutate(winper = line_to_per(odds),
oddsCheck = paste0("between(odds, ",per_to_line(winper+0.05) %>% round(0),", ",
per_to_line(winper-0.05) %>% round(0),")"),
ageCheck = paste0("between(Age1-Age2, ",round(Age1-Age2-2, 1),", ", round(Age1-Age2+2, 1),")"),
ratCheck = paste0("between(r1b-r2b, ",round(r1b-r2b-50, 0),", ", round(r1b-r2b+50, 0),")"),
datCheck = paste0("Date < ", "'",Date,"'"),
ROI = NA
)
View(test)
for (i in 1:100) {
test$ROI[i] <- filtData %>%
filter(expr(parse(text=paste(test[i, 57:60] %>% as.character, collapse=" & ")))) %>%
summarise(avgWin = sum(winnings)/n(),
wins = sum(Result=="win"),
count = n(),
winPer = paste0(round(wins/count * 100,2),"%"),
bet = mean(bet),
ROI = paste0(round(sum(winnings)/(bet*n())*100, 2), "%")) %>%
pull(ROI)
}
filtData %>%
filter(paste(test[i, 57:60] %>% as.character, collapse=" & "))
paste(test[i, 57:60] %>% as.character, collapse=" & ")
?eval_tidy
filtData %>%
filter(eval_tidy(paste(test[i, 57:60] %>% as.character, collapse=" & ")))
eval_tidy(paste(test[i, 57:60] %>% as.character, collapse=" & "))
filtData %>%
filter(eval_tidy(parse(text = paste(test[i, 57:60] %>% as.character, collapse=" & "))))
eval_tidy(parse(text = paste(test[i, 57:60] %>% as.character, collapse=" & ")))
eval_tidy(parse(text = paste(test[i, 57:59] %>% as.character, collapse=" & ")))
filtData %>%
filter(eval_tidy(parse(text = paste(test[i, 57] %>% as.character, collapse=" & "))))
?parse_expr
filtData %>%
filter(eval_tidy(parse_expr(paste(test[i, 57:60] %>% as.character, collapse=" & "))))
for (i in 1:100) {
test$ROI[i] <- filtData %>%
filter(eval_tidy(parse_expr(paste(test[i, 57:60] %>% as.character, collapse=" & ")))) %>%
summarise(avgWin = sum(winnings)/n(),
wins = sum(Result=="win"),
count = n(),
winPer = paste0(round(wins/count * 100,2),"%"),
bet = mean(bet),
ROI = paste0(round(sum(winnings)/(bet*n())*100, 2), "%")) %>%
pull(ROI)
}
View(test)
test$ROI[i] <- filtData %>%
filter(eval_tidy(parse_expr(paste(test[i, 57:60] %>% as.character, collapse=" & ")))) %>%
summarise(avgWin = sum(winnings)/n(),
wins = sum(Result=="win"),
count = n(),
winPer = paste0(round(wins/count * 100,2),"%"),
bet = mean(bet),
ROI = round(sum(winnings)/(bet*n())*100, 2)) %>%
pull(ROI)
View(test)
filtData %>%
filter(eval_tidy(parse_expr(paste(test[i, 57:60] %>% as.character, collapse=" & ")))) %>%
summarise(avgWin = sum(winnings)/n(),
wins = sum(Result=="win"),
count = n(),
winPer = paste0(round(wins/count * 100,2),"%"),
bet = mean(bet),
ROI = round(sum(winnings)/(bet*n())*100, 2)) %>%
pull(ROI)
test <- filtfightsOdds %>%
slice(1:100) %>%
rowwise() %>%
mutate(winper = line_to_per(odds),
oddsCheck = paste0("between(odds, ",per_to_line(winper+0.05) %>% round(0),", ",
per_to_line(winper-0.05) %>% round(0),")"),
ageCheck = paste0("between(Age1-Age2, ",round(Age1-Age2-2, 1),", ", round(Age1-Age2+2, 1),")"),
ratCheck = paste0("between(r1b-r2b, ",round(r1b-r2b-50, 0),", ", round(r1b-r2b+50, 0),")"),
datCheck = paste0("Date < ", "'",Date),
ROI = NA
)
for (i in 1:100) {
test$ROI[i] <- filtData %>%
filter(eval_tidy(parse_expr(paste(test[i, 57:60] %>% as.character, collapse=" & ")))) %>%
summarise(avgWin = sum(winnings)/n(),
wins = sum(Result=="win"),
count = n(),
winPer = paste0(round(wins/count * 100,2),"%"),
bet = mean(bet),
ROI = round(sum(winnings)/(bet*n())*100, 2)) %>%
pull(ROI)
}
paste(test[i, 57:60] %>% as.character, collapse=" & ")
test <- filtfightsOdds %>%
slice(1:100) %>%
rowwise() %>%
mutate(winper = line_to_per(odds),
oddsCheck = paste0("between(odds, ",per_to_line(winper+0.05) %>% round(0),", ",
per_to_line(winper-0.05) %>% round(0),")"),
ageCheck = paste0("between(Age1-Age2, ",round(Age1-Age2-2, 1),", ", round(Age1-Age2+2, 1),")"),
ratCheck = paste0("between(r1b-r2b, ",round(r1b-r2b-50, 0),", ", round(r1b-r2b+50, 0),")"),
datCheck = paste0("Date < ", "'",Date,"'"),
ROI = NA
)
for (i in 1:100) {
test$ROI[i] <- filtData %>%
filter(eval_tidy(parse_expr(paste(test[i, 57:60] %>% as.character, collapse=" & ")))) %>%
summarise(avgWin = sum(winnings)/n(),
wins = sum(Result=="win"),
count = n(),
winPer = paste0(round(wins/count * 100,2),"%"),
bet = mean(bet),
ROI = round(sum(winnings)/(bet*n())*100, 2)) %>%
pull(ROI)
}
View(test)
test <- filtfightsOdds %>%
rowwise() %>%
mutate(winper = line_to_per(odds),
oddsCheck = paste0("between(odds, ",per_to_line(winper+0.05) %>% round(0),", ",
per_to_line(winper-0.05) %>% round(0),")"),
ageCheck = paste0("between(Age1-Age2, ",round(Age1-Age2-2, 1),", ", round(Age1-Age2+2, 1),")"),
ratCheck = paste0("between(r1b-r2b, ",round(r1b-r2b-50, 0),", ", round(r1b-r2b+50, 0),")"),
datCheck = paste0("Date < ", "'",Date,"'"),
ROI = NA
)
print(i)
for (i in 1:nrow(test)) {
test$ROI[i] <- filtData %>%
filter(eval_tidy(parse_expr(paste(test[i, 57:60] %>% as.character, collapse=" & ")))) %>%
summarise(avgWin = sum(winnings)/n(),
wins = sum(Result=="win"),
count = n(),
winPer = paste0(round(wins/count * 100,2),"%"),
bet = mean(bet),
ROI = round(sum(winnings)/(bet*n())*100, 2)) %>%
pull(ROI)
print(i)
}
View(test)
View(test)
test %>% filter(ROI > 0) %>% select(1:6, ROI)
test %>% filter(ROI > 0) %>% select(1:6, ROI)
test %>% filter(ROI > 0) %>% select(1:4, odds, ROI)
test %>% filter(ROI > 0) %>% select(1:4, date, odds, ROI)
test %>% filter(ROI > 0) %>% select(1:4, Date, odds, ROI)
test %>% filter(ROI > 0) %>% select(1:4, Date, odds, ROI) %>% mutate(Bet = 10)
test %>%
filter(ROI > 0) %>%
select(1:4, Date, odds, ROI) %>%
mutate(Bet = 10,  winnings = ifelse(Result %in% c("NC", "draw"), 0, ifelse(odds>0,ifelse(Result=="win", odds*bet/100, -bet),
ifelse(Result=="win", -100/odds * bet, -bet))) %>%
round(2))
test %>%
filter(ROI > 0) %>%
select(1:4, Date, odds, ROI) %>%
mutate(bet = 10,  winnings = ifelse(Result %in% c("NC", "draw"), 0, ifelse(odds>0,ifelse(Result=="win", odds*bet/100, -bet),
ifelse(Result=="win", -100/odds * bet, -bet))) %>%
round(2))
test %>%
filter(ROI > 0) %>%
select(1:4, Date, odds, ROI) %>%
mutate(bet = 10,  winnings = ifelse(Result %in% c("NC", "draw"), 0, ifelse(odds>0,ifelse(Result=="win", odds*bet/100, -bet),
ifelse(Result=="win", -100/odds * bet, -bet))) %>%
round(2)) %>%
View()
test %>%
filter(ROI > 0 & Date >= "2017-01-01") %>%
select(1:4, Date, odds, ROI) %>%
mutate(bet = 10,  winnings = ifelse(Result %in% c("NC", "draw"), 0, ifelse(odds>0,ifelse(Result=="win", odds*bet/100, -bet),
ifelse(Result=="win", -100/odds * bet, -bet))) %>%
round(2)) %>%
View()
test %>%
filter(ROI > 3 & Date >= "2017-01-01") %>%
select(1:4, Date, odds, ROI) %>%
mutate(bet = 10,  winnings = ifelse(Result %in% c("NC", "draw"), 0, ifelse(odds>0,ifelse(Result=="win", odds*bet/100, -bet),
ifelse(Result=="win", -100/odds * bet, -bet))) %>%
round(2)) %>%
View()
test %>%
filter(ROI > 3 & Date >= "2017-01-01") %>%
select(1:4, Date, odds, ROI) %>%
mutate(bet = 10,  winnings = ifelse(Result %in% c("NC", "draw"), 0, ifelse(odds>0,ifelse(Result=="win", odds*bet/100, -bet),
ifelse(Result=="win", -100/odds * bet, -bet))) %>%
round(2)) %>%
sum(winnings)
test2 <- test %>%
filter(ROI > 3 & Date >= "2017-01-01") %>%
select(1:4, Date, odds, ROI) %>%
mutate(bet = 10,  winnings = ifelse(Result %in% c("NC", "draw"), 0, ifelse(odds>0,ifelse(Result=="win", odds*bet/100, -bet),
ifelse(Result=="win", -100/odds * bet, -bet))) %>%
round(2))
test2 %>% pull(winnings) %>% sum
test2 %>% summarise(bet = sum(bet), winnings = sum(winnings))
test2 <- test %>%
filter(ROI > 3 & Date >= "2017-01-01") %>%
select(1:4, Date, odds, ROI) %>%
mutate(bet = 10,  winnings = ifelse(Result %in% c("NC", "draw"), 0, ifelse(odds>0,ifelse(Result=="win", odds*bet/100, -bet),
ifelse(Result=="win", -100/odds * bet, -bet))) %>%
round(2))
View(test2)
write.csv(test, "check.csv")
test <- filtfightsOdds %>%
rowwise() %>%
mutate(winper = line_to_per(odds),
oddsCheck = paste0("between(odds, ",per_to_line(winper+0.05) %>% round(0),", ",
per_to_line(winper-0.05) %>% round(0),")"),
ageCheck = paste0("between(Age1-Age2, ",round(Age1-Age2-2, 1),", ", round(Age1-Age2+2, 1),")"),
ratCheck = paste0("between(r1b-r2b, ",round(r1b-r2b-50, 0),", ", round(r1b-r2b+50, 0),")"),
datCheck = paste0("Date < ", "'",Date,"'"),
ROI = NA,
count = NA
)
for (i in 1:nrow(test)) {
data <- filtData %>%
filter(eval_tidy(parse_expr(paste(test[i, 57:60] %>% as.character, collapse=" & ")))) %>%
summarise(avgWin = sum(winnings)/n(),
wins = sum(Result=="win"),
count = n(),
winPer = paste0(round(wins/count * 100,2),"%"),
bet = mean(bet),
ROI = round(sum(winnings)/(bet*n())*100, 2))
test$ROI[i] <- data %>% pull(ROI)
test$count[i] <- data %>% pull(count)
print(i)
}
test <- test %>%
mutate(bet = 10,  winnings = ifelse(Result %in% c("NC", "draw"), 0, ifelse(odds>0,ifelse(Result=="win", odds*bet/100, -bet),
ifelse(Result=="win", -100/odds * bet, -bet))) %>%
round(2))
write.csv(test, "check.csv")
runApp('Shiny App/MatchPredictor')
