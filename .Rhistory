devtools::install_github("shinysky")``
devtools::install_github("shinysky")
devtools::install_github("shinysky","analytixware")
library(devtools)
devtools::install_github("shinysky","analytixware")
devtools::install_github("shinysky","analytixware")
devtools::install_github("analytixware")
devtools::install_github("analytixware", "shinysky")
devtools::install_github("ShinySky","AnalytixWare")
install_github("ShinySky","AnalytixWare")
require(devtools)
install_github("ShinySky","AnalytixWare")
require("devtools")
library("devtools")
devtools::install_github("AnalytixWare/ShinySky")
shinysky::run.shinysky.example()
devtools::install_github("AnalytixWare/ShinySky")
Sys.getenv("R_LIBS_USER")
devtools::install_github("AnalytixWare/ShinySky")
require("devtools")
devtools::install_github("AnalytixWare/ShinySky")
install.packages('digest', repos='http://cran.us.r-project.org')
devtools::install_github("AnalytixWare/ShinySky")
devtools::install_github("AnalytixWare/ShinySky")
shinysky::
devtools::install_github("AnalytixWare/ShinySky")
install.packages("Rcpp")
devtools::install_github("AnalytixWare/ShinySky")
devtools::install_github("AnalytixWare/ShinySky")
install.packages("rlang")
devtools::install_github("AnalytixWare/ShinySky")
shinysky::run.shinysky.example()
shinysky::run.shinysky.example()
shinysky::run.shinysky.example()
runApp('Shiny App/MatchPredictor')
runApp('Shiny App/MatchPredictor')
shinysky::run.shinysky.example()
runApp('Shiny App/MatchPredictor')
runApp('Shiny App/MatchPredictor')
runApp('Shiny App/MatchPredictor')
runApp('Shiny App/MatchPredictor')
runApp('Shiny App/MatchPredictor')
runApp('Shiny App/MatchPredictor')
runApp('Shiny App/MatchPredictor')
runApp('Shiny App/MatchPredictor')
runApp('Shiny App/MatchPredictor')
runApp('Shiny App/MatchPredictor')
runApp('Shiny App/MatchPredictor')
runApp('Shiny App/MatchPredictor')
?textInput.typeahead
runApp('Shiny App/MatchPredictor')
runApp('Shiny App/MatchPredictor')
fightMetricsEvent <- readRDS(file = "./scripts/5-metrics/data/fightMetricsEvent.rds")
birthdayTable <- readRDS("~/GitHub/MMAscraper/scripts/2-clean-data/data/birthdayTable.rds")
View(birthdayTable)
fightMetricsEvent %>% select(Link1, Fighter1) %>% unique()
fightersTable <- full_join(birthdayTable, fightMetricsEvent %>% select(Link1, Fighter1) %>% unique())
fightersTable <- full_join(birthdayTable, fightMetricsEvent %>% select(Link1, Fighter1) %>% unique(), by = c("link" = "Link1"))
fightMetricsEvent %>% select(Link1) %>% unique()
fightersTable <- fightMetricsEvent %>%
select(Link1, Fighter1, BD1) %>%
unique()
View(fightersTable)
View(fightMetricsEvent)
lastFight <- fightMetricsEvent %>%
group_by(Link1) %>%
arrange(match_id) %>%
slice(n()) %>%
ungroup
lastFight <- lastFight %>%
mutate(wins1 = ifelse(Result == "win", wins1 + 1, wins1),
loss1 = ifelse(Result == "loss", loss1 + 1, loss1),
draw1 = ifelse(Result == "draw", draw1 + 1, draw1),
nc1 = ifelse(Result == "NC", nc1 + 1, nc1)) %>%
select(Link1, Result, Link2, Date, r1a, Fighter1, BD1, wins1, loss1, draw1, nc1, Org) %>%
rename(Link = Link1, Last.Result = Result, Last.Opponent = Link2, Last.Date = Date, rating = r1a, Name = Fighter1,
Birthday = BD1, wins = wins1, loss = loss1, draw = draw1, NC = nc1) %>%
arrange(desc(rating))
View(lastFight)
source('~/GitHub/MMAscraper/scripts/9-various-tables/Current Stats.R', echo=TRUE)
source('~/GitHub/MMAscraper/scripts/9-various-tables/Current Stats.R', echo=TRUE)
fightersTable <- readRDS("~/GitHub/MMAscraper/scripts/9-various-tables/data/fightersTable.rds")
fightersTable <- readRDS("~/GitHub/MMAscraper/scripts/9-various-tables/data/fightersTable.rds")
runApp('Shiny App/MatchPredictor')
?textInput.typeahead
shinysky::run.shinysky.example()
runApp('Shiny App/MatchPredictor')
runApp('Shiny App/MatchPredictor')
as.Date(3350)
as.Date(3350, origin = "1970-01-01")
runApp('Shiny App/MatchPredictor')
class(fightersTable)
library(data.table)
library(tidyverse)
library(data.table)
source('~/GitHub/MMAscraper/scripts/9-various-tables/Current Stats.R', echo=TRUE)
fightersTable <- readRDS("~/GitHub/MMAscraper/scripts/9-various-tables/data/fightersTable.rds")
class(fightersTable)
runApp('Shiny App/MatchPredictor')
as.Date(3432, '1970-01-01')
runApp('Shiny App/MatchPredictor')
?HTML
runApp('Shiny App/MatchPredictor')
runApp('Shiny App/MatchPredictor')
source('~/GitHub/MMAscraper/scripts/9-various-tables/Current Stats.R', echo=TRUE)
View(fightersTable)
source('~/GitHub/MMAscraper/scripts/9-various-tables/Current Stats.R', echo=TRUE)
runApp('Shiny App/MatchPredictor')
fightersTable <- readRDS("~/GitHub/MMAscraper/scripts/9-various-tables/data/fightersTable.rds")
fightMetricsEvent <- readRDS(file = "~/GitHub/MMAscraper/scripts/5-metrics/data/fightMetricsEvent.rds")
library(profvis)
runApp('Shiny App/MatchPredictor')
filtfightsOdds <- readRDS("~/GitHub/MMAscraper/scripts/8-append-odds/data/filtfightsOdds.rds")
View(filtfightsOdds)
library(tidyverse)
filtfightsOdds %>% class
filtfightsOdds %>% group_by(Link1, Link2, Date)
filtfightsOdds %>% group_by(Link1, Link2, Date) %>% summarise(n())
filtfightsOdds %>% group_by(Link1, Link2, Date) %>% summarise(num = n()) %>% arrange(desc(num))
pastOdds <- readRDS("./scripts/7-scrape-odds/data/pastOdds.RDS")
pastOdds
pastOdds %>% select(fighter) %>% unique()
View(pastOdds)
# Events with duplicate links
dupedEvents <- pastOdds %>%
group_by(eventName, eventLink, Date) %>%
summarise(num = n()) %>%
group_by(eventName, Date) %>%
summarise(num = n()) %>%
filter(num > 1) %>%
pull(eventName)
# Find the link that is incorrect
wrongEvents <- c()
for (i in 1:length(dupedEvents)) {
wrongEvents[i] <- sapply(pastOdds %>%
filter(eventName == dupedEvents[i]) %>%
pull(eventLink) %>%
unique(), function(x) stringdist(dupedEvents[i], x)) %>%
which.max() %>%
names()
}
# delete
pastOdds <- pastOdds %>%
filter(!(eventLink %in% wrongEvents))
source('~/.active-rstudio-document', echo=TRUE)
# Fix a few fighter's names, create stripped version of name
pastOdds <- pastOdds %>%
# Fix a few fighter's names, create stripped version of name
pastOdds <- pastOdds %>%
# Fix a few fighter's names, create stripped version of name
pastOdds <- pastOdds %>%
library(tidyverse)
pastOdds <- pastOdds %>%
mutate(fighter = ifelse(fighter == "Jacob-Volkman-1246", "Jacob-Volkmann-3471", fighter),
opponent = ifelse(opponent == "Jacob-Volkman-1246", "Jacob-Volkmann-3471", opponent),
fighter = ifelse(fighter == "Luigi-Vandramini-8636", "Luigi-Vendramini-8636", fighter),
opponent = ifelse(opponent == "Luigi-Vandramini-8636", "Luigi-Vendramini-8636", opponent),
fighter = ifelse(fighter == "Elizeu-Zaleski-5594", "Elizeu-Zaleski-Dos-Santos-6667", fighter),
opponent = ifelse(opponent == "Elizeu-Zaleski-5594", "Elizeu-Zaleski-Dos-Santos-6667", opponent),
fighterLink1s = gsub("(.*)(-\\d*$)", "\\1", fighter) %>% gsub("-", "", .) %>% tolower(),
fighterLink2s = gsub("(.*)(-\\d*$)", "\\1", opponent) %>% gsub("-", "", .) %>% tolower(),
rownum = row_number(),
eventName = gsub(": ", " - ", eventName)) %>%
filter(!(fighter == "Al-Iaquinta-3221" & opponent == "Paul-Felder-5116") &
!(fighter == "Paul-Felder-5116" & opponent == "Al-Iaquinta-3221") &
!(fighter == "John-Howard-692" & opponent == "Shamil-Gamzatov-6071") &
!(fighter == "Shamil-Gamzatov-6071" & opponent == "John-Howard-692"))
filtfights <- filtfights %>%
mutate(fighter1Name = gsub("(.*)(-\\d*$)", "\\1", Link1) %>% gsub("-", "", .) %>% tolower(),
fighter2Name = gsub("(.*)(-\\d*$)", "\\1", Link2) %>% gsub("-", "", .) %>% tolower())
# Begin Matching
filtfightsOdds <- tibble()
i=0
pastOdds <- pastOdds %>%
mutate(Date2 = Date - i + 1)
filtfightsOdds <- inner_join(filtfights, pastOdds, by = c("fighter1Name" = "fighterLink1s", "fighter2Name" = "fighterLink2s", "Date" = "Date2")) %>%
select(colnames(filtfights), '5Dimes', 'rownum') %>%
rbind(filtfightsOdds)
View(filtfightsOdds)
filtfightsOdds <- tibble()
for (i in 0:2) {
pastOdds <- pastOdds %>%
mutate(Date2 = Date - i + 1)
filtfightsOdds <- inner_join(filtfights, pastOdds, by = c("fighter1Name" = "fighterLink1s", "fighter2Name" = "fighterLink2s", "Date" = "Date2")) %>%
select(colnames(filtfights), '5Dimes', 'rownum', 'fighter', 'opponent') %>%
rbind(filtfightsOdds)
}
View(filtfightsOdds)
Sherdog_to_BFO <- filtfightsOdds %>%
select(Link1, fighter) %>%
rename(Sherdog = Link1, BFO = fighter)
Sherdog_to_BFO <- filtfightsOdds %>%
select(Link1, fighter) %>%
rename(Sherdog = Link1, BFO = fighter) %>%
unique()
View(Sherdog_to_BFO)
Sherdog_to_BFO %>% group_by(Sherdog) %>% summarise(n()) %>% View()
View(Sherdog_to_BFO)
Sherdog_to_BFO %>% group_by(BFO) %>% summarise(n()) %>% View()
filtfightsNotMatched <- anti_join(filtfights, filtfightsOdds, by = "match_id")
pastOddsNotMatched <- anti_join(pastOdds, filtfightsOdds, by = "rownum")
filtfightsOdds2 <- tibble()
for (i in 0:2) {
pastOddsNotMatched <- pastOddsNotMatched %>%
mutate(Date2 = Date - i + 1)
filtfightsOdds2 <- inner_join(filtfightsNotMatched, pastOddsNotMatched, by = c("fighter1Name" = "fighterLink1s", "Date" = "Date2")) %>%
select(colnames(filtfights), '5Dimes', 'rownum', 'fighter', 'opponent') %>%
rbind(filtfightsOdds2)
}
Sherdog_to_BFO2 <- filtfightsOdds2 %>%
select(Link1, fighter) %>%
rename(Sherdog = Link1, BFO = fighter) %>%
unique()
View(Sherdog_to_BFO2)
Sherdog_to_BFO <- full_join(Sherdog_to_BFO, Sherdog_to_BFO2)
View(Sherdog_to_BFO)
View(pastOdds)
source('~/GitHub/MMAscraper/scripts/7-scrape-odds/oddsScraper.R', echo=TRUE)
library(lubridate)
source('~/GitHub/MMAscraper/scripts/7-scrape-odds/oddsScraper.R', echo=TRUE)
saveRDS(odds_list, "./scripts/7-scrape-odds/data/odds_list.RDS")
odds_list <- readRDS("./scripts/7-scrape-odds/data/odds_list.RDS")
pastOdds <- tibble()
for (i in 1:length(odds_list$searched_events)) {
pastOdds <- rbind(pastOdds, eventOddsScraper(odds_list$searched_events[i]))
print(i)
}
# Scrape all fighters on bestfightodds.com. Takes about an hour.
while(length(odds_list$toSearch) > 0) {
odds_list <- bind_odds(odds_list, oddsScraper(odds_list$toSearch[1]))
}
#source('./scripts/0-run-scripts/Initial Run.R', echo=TRUE)
source('./scripts/1-raw-data/update-scraper.R', echo=TRUE)
source('./scripts/3-records/recordAdder.R', echo=TRUE)
source('./scripts/4-ratings/add_ratings.R', echo=TRUE)
source('./scripts/5-metrics/metrics.R', echo=TRUE)
source('./scripts/5-metrics/events.R', echo=TRUE)
source('./scripts/7-scrape-odds/futureOdds.R', echo=TRUE)
source('./scripts/7-scrape-odds/updateOdds.R', echo=TRUE)
source('./scripts/8-append-odds/matchOdds-filtfights.R', echo=TRUE)
fightMetricsEvent <- readRDS(file = "./scripts/5-metrics/data/fightMetricsEvent.rds")
lastFight <- fightMetricsEvent %>%
group_by(Link1) %>%
arrange(match_id) %>%
slice(n()) %>%
ungroup
fightersTable <- lastFight %>%
mutate(wins1 = ifelse(Result == "win", wins1 + 1, wins1),
loss1 = ifelse(Result == "loss", loss1 + 1, loss1),
draw1 = ifelse(Result == "draw", draw1 + 1, draw1),
nc1 = ifelse(Result == "NC", nc1 + 1, nc1),
BDchar = as.character(BD1)) %>%
select(Link1, Result, Link2, Date, r1a, Fighter1, BD1, BDchar, wins1, loss1, draw1, nc1, Org) %>%
rename(Link = Link1, Last.Result = Result, Last.Opponent = Link2, Last.Date = Date, rating = r1a, Name = Fighter1,
Birthday = BD1, wins = wins1, loss = loss1, draw = draw1, NC = nc1) %>%
arrange(desc(rating)) %>%
as.data.table()
View(fightersTable)
fights <- readRDS(file = "./scripts/3-records/data/fights_records.rds")
fights2 <- fights %>%
filter(Result %in% c("win", "draw") & Method != "DQ") %>%
mutate(score1 = ifelse(Result == "win", 1, 0.5),
score2 = ifelse(Result == "win", 0, 0.5)) %>%
select(game = match_id, player1 = Link1, score1, player2 = Link2, score2)
View(fights)
View(fights)
fights2 <- fights %>%
mutate(Result2 = Result)
View(fights2)
fights2 %>% filter(Result == "NC") %>% select(Link1, Link2, Date, Result) %>% View()
fightMetrics <- readRDS(file = "./scripts/5-metrics/data/fightMetrics.rds")
events <- tibble(Event = unique(fightMetrics$Event),
Org = gsub(" -.*", "", Event)) %>%
mutate(Org = ifelse(Org == "UFC", gsub(".* -", "", Event), Org),
Org = ifelse(grepl("^UFC - The Ultimate Fighter|^UFC \\d+|^UFC Fight Night|^UFC Live \\d|UFC on Fox \\d+|^UFC on Fuel TV \\d+|^UFC on FX", Event),
"UFC", Org),
Org = ifelse(grepl("Underground Fight Club", Event), "Underground Fight Club", Org),
Org = ifelse(grepl("Bellator Fighting Championships|Bellator MMA|^Bellator \\d{3}", Event), "Bellator", Org),
Org = gsub(" \\d+$", "", Org),
Org = ifelse(grepl("^M-1", Event), "M-1", Org),
Org = ifelse(grepl("^Strikeforce", Event), "Strikeforce", Org),
Org = ifelse(Org == "Pride", "Pride FC", Org),
Org = ifelse(grepl("^Absolute Championship Berkut", Event), "ACB", Org),
Org = ifelse(grepl("^Fight Nights|^EFN - Fight Nights|^FNG - Fight Nights", Event), "FNG", Org),
Org = ifelse(Org == "One FC", "One Championship", Org),
Org = ifelse(grepl("Rizin", Event), "Rizin", Org))
fightMetrics <- fightMetrics %>% full_join(events)
fights2 %>% filter(Result == "NC") %>% select(Link1, Link2, Date, Result) %>% left_join(fightMetrics, by=c("Link1" = "Link1", "Link2" = "Link2", "Date" = "Date"))
fights2 %>% filter(Result == "NC") %>% select(Link1, Link2, Date, Result) %>% left_join(fightMetrics, by=c("Link1" = "Link1", "Link2" = "Link2", "Date" = "Date")) %>% select(colnames(Link1, Link2, Date, Result))
fights2 %>% filter(Result == "NC") %>% select(Link1, Link2, Date, Result) %>% left_join(fightMetrics, by=c("Link1" = "Link1", "Link2" = "Link2", "Date" = "Date")) %>% select(colnames(Link1, Link2, Date, Result.x))
fights2 %>% filter(Result == "NC") %>% select(Link1, Link2, Date, Result) %>% left_join(fightMetrics, by=c("Link1" = "Link1", "Link2" = "Link2", "Date" = "Date")) %>% select(Link1, Link2, Date, Result, Org)
fights2 %>% filter(Result == "NC") %>% select(Link1, Link2, Date, Result) %>% left_join(fightMetrics, by=c("Link1" = "Link1", "Link2" = "Link2", "Date" = "Date")) %>% select(Link1, Link2, Date, Result.x, Org)
fights2 %>% filter(Result == "NC") %>% select(Link1, Link2, Date, Result) %>% left_join(fightMetrics, by=c("Link1" = "Link1", "Link2" = "Link2", "Date" = "Date")) %>% select(Link1, Link2, Date, Result.x, Org) %>% View()
View(fights2)
# Change select fights from NC to Wins/Losses
fights2 <- fights %>%
mutate(Result2 = Result,
Result2 = ifelse(Link1 == "Daniel-Cormier-52311" & Link2 == "Jon-Jones-27944" & Date == "2017-07-29", "loss", Result2),
Result2 = ifelse(Link1 == "Anderson-Silva-1356" & Link2 == "Nick-Diaz-2831" & Date == "2015-01-31", "win", Result2),
Result2 = ifelse(Link1 == "Brian-Ortega-65310" & Link2 == "Mike-de-la-Torre-17915" & Date == "2014-07-26", "win", Result2),
Result2 = ifelse(Link1 == "Khalil-Rountree-77674" & Link2 == "Michal-Oleksiejczuk-156397" & Date == "2017-12-30", "loss", Result2),
Result2 = ifelse(Link1 == "Kelvin-Gastelum-74700" & Link2 == "Vitor-Belfort-156" & Date == "2017-03-11", "win", Result2),
Result2 = ifelse(Link1 == "Adam-Milstead-60258" & Link2 == "Curtis-Blaydes-172939" & Date == "2017-02-04", "loss", Result2),
Result2 = ifelse(Link1 == "Alex-Morono-64894" & Link2 == "Niko-Price-96921" & Date == "2017-02-04", "loss", Result2),
Result2 = ifelse(Link1 == "Brock-Lesnar-17522" & Link2 == "Mark-Hunt-10668" & Date == "2016-07-09", "win", Result2),
Result2 = ifelse(Link1 == "Bubba-Bush-29111" & Link2 == "Kevin-Casey-24121" & Date == "2014-07-05", "loss", Result2),
Result2 = ifelse(Link1 == "Damon-Jackson-113767" & Link2 == "Rony-Mariano-Bezerra-38190" & Date == "2015-05-30", "loss", Result2),
Result2 = ifelse(Link1 == "Hector-Lombard-11292" & Link2 == "Joshua-Burkman-10003" & Date == "2015-01-03", "win", Result2),
Result2 = ifelse(Link1 == "Jerrod-Sanders-48156" & Link2 == "Pedro-Munhoz-52407" & Date == "2014-10-04", "loss", Result2),
Result2 = ifelse(Link1 == "Keith-Berish-46314" & Link2 == "Robert-Drysdale-67894" & Date == "2014-07-06", "loss", Result2),
Result2 = ifelse(Link1 == "Louis-Gaudinot-45230" & Link2 == "Phil-Harris-8753" & Date == "2014-03-08", "win", Result2),
Result2 = ifelse(Link1 == "Chico-Camus-42850" & Link2 == "Yaotzin-Meza-15937" & Date == "2014-01-25", "win", Result2),
Result2 = ifelse(Link1 == "Dennis-Siver-9817" & Link2 == "Manny-Gamburyan-5185" & Date == "2013-12-28", "win", Result2),
Result2 = ifelse(Link1 == "Yancy-Medeiros-27738" & Link2 == "Yves-Edwards-344" & Date == "2013-11-06", "win", Result2),
Result2 = ifelse(Link1 == "Jessica-Eye-39575" & Link2 == "Sarah-Kaufman-16524" & Date == "2013-10-19", "win", Result2),
Result2 = ifelse(Link1 == "Jim-Miller-14463" & Link2 == "Pat-Healy-6246" & Date == "2013-04-27", "loss", Result2),
Result2 = ifelse(Link1 == "Alex-Caceres-41586" & Link2 == "Kyung-Ho-Kang-24067" & Date == "2013-03-03", "win", Result2),
Result2 = ifelse(Link1 == "Che-Mills-8800" & Link2 == "Matt-Riddle-34072" & Date == "2013-02-16", "loss", Result2),
Result2 = ifelse(Link1 == "Igor-Pokrajac-7621" & Link2 == "Joey-Beltran-21219" & Date == "2012-12-15", "loss", Result2),
Result2 = ifelse(Link1 == "Stanislav-Nedkov-27115" & Link2 == "Thiago-Silva-14396" & Date == "2012-11-10", "loss", Result2),
Result2 = ifelse(Link1 == "Ed-Herman-6561" & Link2 == "Jake-Shields-502" & Date == "2012-08-11", "loss", Result2),
Result2 = ifelse(Link1 == "Francisco-Rivera-11908" & Link2 == "Roland-Delorme-37351" & Date == "2012-07-21", "win", Result2),
Result2 = ifelse(Link1 == "Chris-Clements-13469" & Link2 == "Matt-Riddle-34072" & Date == "2012-07-21", "loss", Result2),
Result2 = ifelse(Link1 == "Brandon-Vera-4886" & Link2 == "Thiago-Silva-14396" & Date == "2011-01-01", "loss", Result2),
Result2 = ifelse(Link1 == "Brandon-Vera-4886" & Link2 == "Thiago-Silva-14396" & Date == "2011-01-01", "loss", Result2),
Result2 = ifelse(Link1 == "Brandon-Vera-4886" & Link2 == "Thiago-Silva-14396" & Date == "2011-01-01", "loss", Result2),
Result2 = ifelse(Link1 == "Brandon-Vera-4886" & Link2 == "Thiago-Silva-14396" & Date == "2011-01-01", "loss", Result2),
Result2 = ifelse(Link1 == "Brandon-Vera-4886" & Link2 == "Thiago-Silva-14396" & Date == "2011-01-01", "loss", Result2),
)
Result2 = ifelse(Link1 == "Brandon-Vera-4886" & Link2 == "Thiago-Silva-14396" & Date == "2011-01-01", "loss", Result2),fights2 <- fights %>%
filter(Result %in% c("win", "draw") & Method != "DQ") %>%
mutate(score1 = ifelse(Result == "win", 1, 0.5),
score2 = ifelse(Result == "win", 0, 0.5)) %>%
select(game = match_id, player1 = Link1, score1, player2 = Link2, score2)
fights <- readRDS(file = "./scripts/3-records/data/fights_records.rds")
# Change select fights from NC to Wins/Losses
{
fights2 <- fights %>%
mutate(Result2 = Result,
Result2 = ifelse(Link1 == "Daniel-Cormier-52311" & Link2 == "Jon-Jones-27944" & Date == "2017-07-29", "loss", Result2),
Result2 = ifelse(Link1 == "Anderson-Silva-1356" & Link2 == "Nick-Diaz-2831" & Date == "2015-01-31", "win", Result2),
Result2 = ifelse(Link1 == "Brian-Ortega-65310" & Link2 == "Mike-de-la-Torre-17915" & Date == "2014-07-26", "win", Result2),
Result2 = ifelse(Link1 == "Khalil-Rountree-77674" & Link2 == "Michal-Oleksiejczuk-156397" & Date == "2017-12-30", "loss", Result2),
Result2 = ifelse(Link1 == "Kelvin-Gastelum-74700" & Link2 == "Vitor-Belfort-156" & Date == "2017-03-11", "win", Result2),
Result2 = ifelse(Link1 == "Adam-Milstead-60258" & Link2 == "Curtis-Blaydes-172939" & Date == "2017-02-04", "loss", Result2),
Result2 = ifelse(Link1 == "Alex-Morono-64894" & Link2 == "Niko-Price-96921" & Date == "2017-02-04", "loss", Result2),
Result2 = ifelse(Link1 == "Brock-Lesnar-17522" & Link2 == "Mark-Hunt-10668" & Date == "2016-07-09", "win", Result2),
Result2 = ifelse(Link1 == "Bubba-Bush-29111" & Link2 == "Kevin-Casey-24121" & Date == "2014-07-05", "loss", Result2),
Result2 = ifelse(Link1 == "Damon-Jackson-113767" & Link2 == "Rony-Mariano-Bezerra-38190" & Date == "2015-05-30", "loss", Result2),
Result2 = ifelse(Link1 == "Hector-Lombard-11292" & Link2 == "Joshua-Burkman-10003" & Date == "2015-01-03", "win", Result2),
Result2 = ifelse(Link1 == "Jerrod-Sanders-48156" & Link2 == "Pedro-Munhoz-52407" & Date == "2014-10-04", "loss", Result2),
Result2 = ifelse(Link1 == "Keith-Berish-46314" & Link2 == "Robert-Drysdale-67894" & Date == "2014-07-06", "loss", Result2),
Result2 = ifelse(Link1 == "Louis-Gaudinot-45230" & Link2 == "Phil-Harris-8753" & Date == "2014-03-08", "win", Result2),
Result2 = ifelse(Link1 == "Chico-Camus-42850" & Link2 == "Yaotzin-Meza-15937" & Date == "2014-01-25", "win", Result2),
Result2 = ifelse(Link1 == "Dennis-Siver-9817" & Link2 == "Manny-Gamburyan-5185" & Date == "2013-12-28", "win", Result2),
Result2 = ifelse(Link1 == "Yancy-Medeiros-27738" & Link2 == "Yves-Edwards-344" & Date == "2013-11-06", "win", Result2),
Result2 = ifelse(Link1 == "Jessica-Eye-39575" & Link2 == "Sarah-Kaufman-16524" & Date == "2013-10-19", "win", Result2),
Result2 = ifelse(Link1 == "Jim-Miller-14463" & Link2 == "Pat-Healy-6246" & Date == "2013-04-27", "loss", Result2),
Result2 = ifelse(Link1 == "Alex-Caceres-41586" & Link2 == "Kyung-Ho-Kang-24067" & Date == "2013-03-03", "win", Result2),
Result2 = ifelse(Link1 == "Che-Mills-8800" & Link2 == "Matt-Riddle-34072" & Date == "2013-02-16", "loss", Result2),
Result2 = ifelse(Link1 == "Igor-Pokrajac-7621" & Link2 == "Joey-Beltran-21219" & Date == "2012-12-15", "loss", Result2),
Result2 = ifelse(Link1 == "Stanislav-Nedkov-27115" & Link2 == "Thiago-Silva-14396" & Date == "2012-11-10", "loss", Result2),
Result2 = ifelse(Link1 == "Ed-Herman-6561" & Link2 == "Jake-Shields-502" & Date == "2012-08-11", "loss", Result2),
Result2 = ifelse(Link1 == "Francisco-Rivera-11908" & Link2 == "Roland-Delorme-37351" & Date == "2012-07-21", "win", Result2),
Result2 = ifelse(Link1 == "Chris-Clements-13469" & Link2 == "Matt-Riddle-34072" & Date == "2012-07-21", "loss", Result2),
Result2 = ifelse(Link1 == "Brandon-Vera-4886" & Link2 == "Thiago-Silva-14396" & Date == "2011-01-01", "loss", Result2),
Result2 = ifelse(Link1 == "Dong-Hyun-Kim-16374" & Link2 == "Karo-Parisyan-5153" & Date == "2009-01-31", "loss", Result2),
Result2 = ifelse(Link1 == "Brandon-Vera-4886" & Link2 == "Thiago-Silva-14396" & Date == "2011-01-01", "loss", Result2)
)
}
fights2 %>% filter(Result == "NC")
fights2 %>% filter(Result == "NC") %>% View()
fights2 <- fights %>%
filter(Result2 %in% c("win", "draw", "loss") & Method != "DQ") %>%
mutate(score1 = ifelse(Result == "win", 1, 0.5),
score1 = ifelse(Result == "loss", 0, score1),
score2 = 1-score1) %>%
select(game = match_id, player1 = Link1, score1, player2 = Link2, score2)
fights <- readRDS(file = "./scripts/3-records/data/fights_records.rds")
# Change select fights from NC to Wins/Losses
{
fights2 <- fights %>%
mutate(Result2 = Result,
Result2 = ifelse(Link1 == "Daniel-Cormier-52311" & Link2 == "Jon-Jones-27944" & Date == "2017-07-29", "loss", Result2),
Result2 = ifelse(Link1 == "Anderson-Silva-1356" & Link2 == "Nick-Diaz-2831" & Date == "2015-01-31", "win", Result2),
Result2 = ifelse(Link1 == "Brian-Ortega-65310" & Link2 == "Mike-de-la-Torre-17915" & Date == "2014-07-26", "win", Result2),
Result2 = ifelse(Link1 == "Khalil-Rountree-77674" & Link2 == "Michal-Oleksiejczuk-156397" & Date == "2017-12-30", "loss", Result2),
Result2 = ifelse(Link1 == "Kelvin-Gastelum-74700" & Link2 == "Vitor-Belfort-156" & Date == "2017-03-11", "win", Result2),
Result2 = ifelse(Link1 == "Adam-Milstead-60258" & Link2 == "Curtis-Blaydes-172939" & Date == "2017-02-04", "loss", Result2),
Result2 = ifelse(Link1 == "Alex-Morono-64894" & Link2 == "Niko-Price-96921" & Date == "2017-02-04", "loss", Result2),
Result2 = ifelse(Link1 == "Brock-Lesnar-17522" & Link2 == "Mark-Hunt-10668" & Date == "2016-07-09", "win", Result2),
Result2 = ifelse(Link1 == "Bubba-Bush-29111" & Link2 == "Kevin-Casey-24121" & Date == "2014-07-05", "loss", Result2),
Result2 = ifelse(Link1 == "Damon-Jackson-113767" & Link2 == "Rony-Mariano-Bezerra-38190" & Date == "2015-05-30", "loss", Result2),
Result2 = ifelse(Link1 == "Hector-Lombard-11292" & Link2 == "Joshua-Burkman-10003" & Date == "2015-01-03", "win", Result2),
Result2 = ifelse(Link1 == "Jerrod-Sanders-48156" & Link2 == "Pedro-Munhoz-52407" & Date == "2014-10-04", "loss", Result2),
Result2 = ifelse(Link1 == "Keith-Berish-46314" & Link2 == "Robert-Drysdale-67894" & Date == "2014-07-06", "loss", Result2),
Result2 = ifelse(Link1 == "Louis-Gaudinot-45230" & Link2 == "Phil-Harris-8753" & Date == "2014-03-08", "win", Result2),
Result2 = ifelse(Link1 == "Chico-Camus-42850" & Link2 == "Yaotzin-Meza-15937" & Date == "2014-01-25", "win", Result2),
Result2 = ifelse(Link1 == "Dennis-Siver-9817" & Link2 == "Manny-Gamburyan-5185" & Date == "2013-12-28", "win", Result2),
Result2 = ifelse(Link1 == "Yancy-Medeiros-27738" & Link2 == "Yves-Edwards-344" & Date == "2013-11-06", "win", Result2),
Result2 = ifelse(Link1 == "Jessica-Eye-39575" & Link2 == "Sarah-Kaufman-16524" & Date == "2013-10-19", "win", Result2),
Result2 = ifelse(Link1 == "Jim-Miller-14463" & Link2 == "Pat-Healy-6246" & Date == "2013-04-27", "loss", Result2),
Result2 = ifelse(Link1 == "Alex-Caceres-41586" & Link2 == "Kyung-Ho-Kang-24067" & Date == "2013-03-03", "win", Result2),
Result2 = ifelse(Link1 == "Che-Mills-8800" & Link2 == "Matt-Riddle-34072" & Date == "2013-02-16", "loss", Result2),
Result2 = ifelse(Link1 == "Igor-Pokrajac-7621" & Link2 == "Joey-Beltran-21219" & Date == "2012-12-15", "loss", Result2),
Result2 = ifelse(Link1 == "Stanislav-Nedkov-27115" & Link2 == "Thiago-Silva-14396" & Date == "2012-11-10", "loss", Result2),
Result2 = ifelse(Link1 == "Ed-Herman-6561" & Link2 == "Jake-Shields-502" & Date == "2012-08-11", "loss", Result2),
Result2 = ifelse(Link1 == "Francisco-Rivera-11908" & Link2 == "Roland-Delorme-37351" & Date == "2012-07-21", "win", Result2),
Result2 = ifelse(Link1 == "Chris-Clements-13469" & Link2 == "Matt-Riddle-34072" & Date == "2012-07-21", "loss", Result2),
Result2 = ifelse(Link1 == "Brandon-Vera-4886" & Link2 == "Thiago-Silva-14396" & Date == "2011-01-01", "loss", Result2),
Result2 = ifelse(Link1 == "Dong-Hyun-Kim-16374" & Link2 == "Karo-Parisyan-5153" & Date == "2009-01-31", "loss", Result2),
Result2 = ifelse(Link1 == "Brandon-Vera-4886" & Link2 == "Thiago-Silva-14396" & Date == "2011-01-01", "loss", Result2)
)
}
fights2 <- fights2 %>%
filter(Result2 %in% c("win", "draw", "loss") & Method != "DQ") %>%
mutate(score1 = ifelse(Result == "win", 1, 0.5),
score1 = ifelse(Result == "loss", 0, score1),
score2 = 1-score1) %>%
select(game = match_id, player1 = Link1, score1, player2 = Link2, score2)
fights2 <- as_widecr(fights2)
View(fights2)
# Change select fights from NC to Wins/Losses
{
fights2 <- fights %>%
mutate(Result2 = Result,
Result2 = ifelse(Link1 == "Daniel-Cormier-52311" & Link2 == "Jon-Jones-27944" & Date == "2017-07-29", "loss", Result2),
Result2 = ifelse(Link1 == "Anderson-Silva-1356" & Link2 == "Nick-Diaz-2831" & Date == "2015-01-31", "win", Result2),
Result2 = ifelse(Link1 == "Brian-Ortega-65310" & Link2 == "Mike-de-la-Torre-17915" & Date == "2014-07-26", "win", Result2),
Result2 = ifelse(Link1 == "Khalil-Rountree-77674" & Link2 == "Michal-Oleksiejczuk-156397" & Date == "2017-12-30", "loss", Result2),
Result2 = ifelse(Link1 == "Kelvin-Gastelum-74700" & Link2 == "Vitor-Belfort-156" & Date == "2017-03-11", "win", Result2),
Result2 = ifelse(Link1 == "Adam-Milstead-60258" & Link2 == "Curtis-Blaydes-172939" & Date == "2017-02-04", "loss", Result2),
Result2 = ifelse(Link1 == "Alex-Morono-64894" & Link2 == "Niko-Price-96921" & Date == "2017-02-04", "loss", Result2),
Result2 = ifelse(Link1 == "Brock-Lesnar-17522" & Link2 == "Mark-Hunt-10668" & Date == "2016-07-09", "win", Result2),
Result2 = ifelse(Link1 == "Bubba-Bush-29111" & Link2 == "Kevin-Casey-24121" & Date == "2014-07-05", "loss", Result2),
Result2 = ifelse(Link1 == "Damon-Jackson-113767" & Link2 == "Rony-Mariano-Bezerra-38190" & Date == "2015-05-30", "loss", Result2),
Result2 = ifelse(Link1 == "Hector-Lombard-11292" & Link2 == "Joshua-Burkman-10003" & Date == "2015-01-03", "win", Result2),
Result2 = ifelse(Link1 == "Jerrod-Sanders-48156" & Link2 == "Pedro-Munhoz-52407" & Date == "2014-10-04", "loss", Result2),
Result2 = ifelse(Link1 == "Keith-Berish-46314" & Link2 == "Robert-Drysdale-67894" & Date == "2014-07-06", "loss", Result2),
Result2 = ifelse(Link1 == "Louis-Gaudinot-45230" & Link2 == "Phil-Harris-8753" & Date == "2014-03-08", "win", Result2),
Result2 = ifelse(Link1 == "Chico-Camus-42850" & Link2 == "Yaotzin-Meza-15937" & Date == "2014-01-25", "win", Result2),
Result2 = ifelse(Link1 == "Dennis-Siver-9817" & Link2 == "Manny-Gamburyan-5185" & Date == "2013-12-28", "win", Result2),
Result2 = ifelse(Link1 == "Yancy-Medeiros-27738" & Link2 == "Yves-Edwards-344" & Date == "2013-11-06", "win", Result2),
Result2 = ifelse(Link1 == "Jessica-Eye-39575" & Link2 == "Sarah-Kaufman-16524" & Date == "2013-10-19", "win", Result2),
Result2 = ifelse(Link1 == "Jim-Miller-14463" & Link2 == "Pat-Healy-6246" & Date == "2013-04-27", "loss", Result2),
Result2 = ifelse(Link1 == "Alex-Caceres-41586" & Link2 == "Kyung-Ho-Kang-24067" & Date == "2013-03-03", "win", Result2),
Result2 = ifelse(Link1 == "Che-Mills-8800" & Link2 == "Matt-Riddle-34072" & Date == "2013-02-16", "loss", Result2),
Result2 = ifelse(Link1 == "Igor-Pokrajac-7621" & Link2 == "Joey-Beltran-21219" & Date == "2012-12-15", "loss", Result2),
Result2 = ifelse(Link1 == "Stanislav-Nedkov-27115" & Link2 == "Thiago-Silva-14396" & Date == "2012-11-10", "loss", Result2),
Result2 = ifelse(Link1 == "Ed-Herman-6561" & Link2 == "Jake-Shields-502" & Date == "2012-08-11", "loss", Result2),
Result2 = ifelse(Link1 == "Francisco-Rivera-11908" & Link2 == "Roland-Delorme-37351" & Date == "2012-07-21", "win", Result2),
Result2 = ifelse(Link1 == "Chris-Clements-13469" & Link2 == "Matt-Riddle-34072" & Date == "2012-07-21", "loss", Result2),
Result2 = ifelse(Link1 == "Brandon-Vera-4886" & Link2 == "Thiago-Silva-14396" & Date == "2011-01-01", "loss", Result2),
Result2 = ifelse(Link1 == "Dong-Hyun-Kim-16374" & Link2 == "Karo-Parisyan-5153" & Date == "2009-01-31", "loss", Result2),
Result2 = ifelse(Link1 == "Brandon-Vera-4886" & Link2 == "Thiago-Silva-14396" & Date == "2011-01-01", "loss", Result2)
)
}
fights2 <- fights2 %>%
filter(Result2 %in% c("win", "draw", "loss") & Method != "DQ") %>%
mutate(score1 = ifelse(Result2 == "win", 1, 0.5),
score1 = ifelse(Result2 == "loss", 0, score1),
score2 = 1-score1) %>%
select(game = match_id, player1 = Link1, score1, player2 = Link2, score2)
fights2 <- as_widecr(fights2)
View(fights2)
# 150 was shown to be the optimal K
elo <- add_elo_ratings(fights2, K=150, initial_ratings = 1000)
fightsM <- fights %>%
filter(Result %in% c("win", "draw") & Method != "DQ")
fightsElo <- full_join(fightsM, elo, by = c("match_id" = "game")) %>%
select(match_id, Link1, Result, Link2, Method, Method_d, Event, Date,
rating1Before, rating2Before, rating1After, rating2After) %>%
rename(r1b = rating1Before, r2b = rating2Before, r1a = rating1After, r2a = rating2After) %>%
mutate_at(.vars = vars(r1b:r2a),
.funs = round)
fightsEloLong <- fightsElo %>%
select(match_id, Link1, Date, r1a) %>%
full_join(fightsElo %>%
select(match_id, Link2, Date, r2a),
by = c("match_id" = "match_id", "Link1" = "Link2",
"Date" = "Date", "r1a" = "r2a")) %>%
rename(Link = Link1, rating = r1a) %>%
arrange(Date)
fights <- merge(fightsElo, fightsM) %>%
arrange(match_id)
rm(elo, fights2, fightsElo, fightsEloLong, fightsM)
saveRDS(fights, file = "./scripts/4-ratings/data/fightsElo.rds")
source('./scripts/5-metrics/metrics.R', echo=TRUE)
source('./scripts/5-metrics/events.R', echo=TRUE)
source('./scripts/7-scrape-odds/futureOdds.R', echo=TRUE)
source('./scripts/7-scrape-odds/updateOdds.R', echo=TRUE)
source('./scripts/8-append-odds/matchOdds-filtfights.R', echo=TRUE)
fightMetricsEvent <- readRDS(file = "./scripts/5-metrics/data/fightMetricsEvent.rds")
lastFight <- fightMetricsEvent %>%
group_by(Link1) %>%
arrange(match_id) %>%
slice(n()) %>%
ungroup
fightersTable <- lastFight %>%
mutate(wins1 = ifelse(Result == "win", wins1 + 1, wins1),
loss1 = ifelse(Result == "loss", loss1 + 1, loss1),
draw1 = ifelse(Result == "draw", draw1 + 1, draw1),
nc1 = ifelse(Result == "NC", nc1 + 1, nc1),
BDchar = as.character(BD1)) %>%
select(Link1, Result, Link2, Date, r1a, Fighter1, BD1, BDchar, wins1, loss1, draw1, nc1, Org) %>%
rename(Link = Link1, Last.Result = Result, Last.Opponent = Link2, Last.Date = Date, rating = r1a, Name = Fighter1,
Birthday = BD1, wins = wins1, loss = loss1, draw = draw1, NC = nc1) %>%
arrange(desc(rating)) %>%
as.data.table()
View(lastFight)
View(fightersTable)
View(fightMetricsEvent)
