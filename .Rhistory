ROI3 > -11) %>%
group_by(year(Date), Org == "UFC") %>%
summarise(
fights = n(),
winnings = sum(winnings),
ROI = round(sum(winnings)/sum(bet)*100,2),
winper = sum(Result=="win")/n()
)
test %>%
filter(Date >= '2019-01-01' & count3 > 50 & Result %in% c("win", "loss") & (((ROI3>=3 | ROI4>=3) & odds>0) | (ROI3>=10 & odds<0)) &
ROI3 > -11) %>%
group_by(year(Date)) %>%
summarise(
fights = n(),
winnings = sum(winnings),
ROI = round(sum(winnings)/sum(bet)*100,2),
winper = sum(Result=="win")/n()
)
test %>%
filter(Date >= '2019-01-01' & count3 > 50 & Result %in% c("win", "loss") & (((ROI3>=3 | ROI4>=3) & odds>0) | (ROI3>=10 & odds<0)) &
ROI3 > -11) %>%
group_by(Org) %>%
summarise(
fights = n(),
winnings = sum(winnings),
ROI = round(sum(winnings)/sum(bet)*100,2),
winper = sum(Result=="win")/n()
)
test %>%
filter(Date >= '2019-01-01' & count3 > 50 & Result %in% c("win", "loss") & (((ROI3>=3 | ROI4>=3) & odds>0) | (ROI3>=10 & odds<0)) &
ROI3 > -11) %>%
group_by(Org) %>%
summarise(
fights = n(),
winnings = sum(winnings),
ROI = round(sum(winnings)/sum(bet)*100,2),
winper = sum(Result=="win")/n()
) %>% View
test %>%
filter(Date >= '2018-01-01' & count3 > 50 & Result %in% c("win", "loss") & (((ROI3>=3 | ROI4>=3) & odds>0) | (ROI3>=10 & odds<0)) &
ROI3 > -11) %>%
group_by(Org) %>%
summarise(
fights = n(),
winnings = sum(winnings),
ROI = round(sum(winnings)/sum(bet)*100,2),
winper = sum(Result=="win")/n()
) %>% View
fightMetrics <- readRDS(file = "./scripts/5-metrics/data/fightMetrics.rds")
events <- tibble(Event = unique(fightMetrics$Event),
Org = gsub(" -.*", "", Event)) %>%
mutate(Org = ifelse(Org == "UFC", gsub(".* -", "", Event), Org),
Org = ifelse(grepl("^UFC - The Ultimate Fighter|^UFC \\d+|^UFC Fight Night|^UFC Live \\d|UFC on Fox \\d+|^UFC on Fuel TV \\d+|^UFC on FX|^UFC on ESPN", Event),
"UFC", Org),
Org = ifelse(grepl("Underground Fight Club", Event), "Underground Fight Club", Org),
Org = ifelse(grepl("Bellator Fighting Championships|Bellator MMA|^Bellator \\d{3}|Bellator New Castle", Event), "Bellator", Org),
Org = gsub(" \\d+$", "", Org),
Org = ifelse(grepl("^M-1", Event), "M-1", Org),
Org = ifelse(grepl("^Strikeforce", Event), "Strikeforce", Org),
Org = ifelse(Org == "Pride", "Pride FC", Org),
Org = ifelse(grepl("^Absolute Championship Berkut", Event), "ACB", Org),
Org = ifelse(grepl("^Fight Nights|^EFN - Fight Nights|^FNG - Fight Nights", Event), "FNG", Org),
Org = ifelse(Org == "One FC", "One Championship", Org),
Org = ifelse(grepl("Rizin", Event), "Rizin", Org),
Org = ifelse(Event == "EFN 50 - Emelianenko vs. Maldonado", "FNG", Org),
Org = ifelse(grepl("Dana White", Org), "Dana White's TNCS", Org))
events
events %>% View
events %>% group_by(Org) %>% summarise(n()) %>% View
fightMetrics <- fightMetrics %>% full_join(events)
fightMetrics <- fightMetrics %>% filter(year(Date)>=2018) %>% group_by(Org) %>% summarise(n()) %>% View
fightMetrics <- readRDS(file = "./scripts/5-metrics/data/fightMetrics.rds")
events <- tibble(Event = unique(fightMetrics$Event),
Org = gsub(" -.*", "", Event)) %>%
mutate(Org = ifelse(Org == "UFC", gsub(".* -", "", Event), Org),
Org = ifelse(grepl("^UFC - The Ultimate Fighter|^UFC \\d+|^UFC Fight Night|^UFC Live \\d|UFC on Fox \\d+|^UFC on Fuel TV \\d+|^UFC on FX|^UFC on ESPN", Event),
"UFC", Org),
Org = ifelse(grepl("Underground Fight Club", Event), "Underground Fight Club", Org),
Org = ifelse(grepl("Bellator Fighting Championships|Bellator MMA|^Bellator \\d{3}|Bellator Newcastle", Event), "Bellator", Org),
Org = gsub(" \\d+$", "", Org),
Org = ifelse(grepl("^M-1", Event), "M-1", Org),
Org = ifelse(grepl("^Strikeforce", Event), "Strikeforce", Org),
Org = ifelse(Org == "Pride", "Pride FC", Org),
Org = ifelse(grepl("^Absolute Championship Berkut", Event), "ACB", Org),
Org = ifelse(grepl("^Fight Nights|^EFN - Fight Nights|^FNG - Fight Nights", Event), "FNG", Org),
Org = ifelse(Org == "One FC", "One Championship", Org),
Org = ifelse(grepl("Rizin", Event), "Rizin", Org),
Org = ifelse(Event == "EFN 50 - Emelianenko vs. Maldonado", "FNG", Org),
Org = ifelse(grepl("Dana White", Org), "Dana White's TNCS", Org))
fightMetrics <- fightMetrics %>% filter(year(Date)>=2018) %>% group_by(Org) %>% summarise(n()) %>% View
events <- tibble(Event = unique(fightMetrics$Event),
Org = gsub(" -.*", "", Event)) %>%
mutate(Org = ifelse(Org == "UFC", gsub(".* -", "", Event), Org),
Org = ifelse(grepl("^UFC - The Ultimate Fighter|^UFC \\d+|^UFC Fight Night|^UFC Live \\d|UFC on Fox \\d+|^UFC on Fuel TV \\d+|^UFC on FX|^UFC on ESPN", Event),
"UFC", Org),
Org = ifelse(grepl("Underground Fight Club", Event), "Underground Fight Club", Org),
Org = ifelse(grepl("Bellator Fighting Championships|Bellator MMA|^Bellator \\d{3}|Bellator Newcastle", Event), "Bellator", Org),
Org = gsub(" \\d+$", "", Org),
Org = ifelse(grepl("^M-1", Event), "M-1", Org),
Org = ifelse(grepl("^Strikeforce", Event), "Strikeforce", Org),
Org = ifelse(Org == "Pride", "Pride FC", Org),
Org = ifelse(grepl("^Absolute Championship Berkut", Event), "ACB", Org),
Org = ifelse(grepl("^Fight Nights|^EFN - Fight Nights|^FNG - Fight Nights", Event), "FNG", Org),
Org = ifelse(Org == "One FC", "One Championship", Org),
Org = ifelse(grepl("Rizin", Event), "Rizin", Org),
Org = ifelse(Event == "EFN 50 - Emelianenko vs. Maldonado", "FNG", Org),
Org = ifelse(grepl("Dana White", Org), "Dana White's TNCS", Org))
fightMetrics <- fightMetrics %>% full_join(events)
fightMetrics <- fightMetrics %>% filter(year(Date)>=2018) %>% group_by(Org) %>% summarise(n()) %>% View
fightMetrics <- readRDS(file = "./scripts/5-metrics/data/fightMetrics.rds")
events <- tibble(Event = unique(fightMetrics$Event),
Org = gsub(" -.*", "", Event)) %>%
mutate(Org = ifelse(Org == "UFC", gsub(".* -", "", Event), Org),
Org = ifelse(grepl("^UFC - The Ultimate Fighter|^UFC \\d+|^UFC Fight Night|^UFC Live \\d|UFC on Fox \\d+|^UFC on Fuel TV \\d+|^UFC on FX|^UFC on ESPN", Event),
"UFC", Org),
Org = ifelse(grepl("Underground Fight Club", Event), "Underground Fight Club", Org),
Org = ifelse(grepl("Bellator Fighting Championships|Bellator MMA|^Bellator \\d{3}|Bellator Newcastle", Event), "Bellator", Org),
Org = gsub(" \\d+$", "", Org),
Org = ifelse(grepl("^M-1", Event), "M-1", Org),
Org = ifelse(grepl("^Strikeforce", Event), "Strikeforce", Org),
Org = ifelse(Org == "Pride", "Pride FC", Org),
Org = ifelse(grepl("^Absolute Championship Berkut", Event), "ACB", Org),
Org = ifelse(grepl("^Fight Nights|^EFN - Fight Nights|^FNG - Fight Nights", Event), "FNG", Org),
Org = ifelse(Org == "One FC", "One Championship", Org),
Org = ifelse(grepl("Rizin", Event), "Rizin", Org),
Org = ifelse(Event == "EFN 50 - Emelianenko vs. Maldonado", "FNG", Org),
Org = ifelse(grepl("Dana White", Org), "Dana White's TNCS", Org))
fightMetrics <- fightMetrics %>% full_join(events)
View(fightMetrics)
fightMetrics %>% filter(Org == "PFL")
fightMetrics %>% filter(Org == "PFL") %>% View
source('./scripts/5-metrics/metrics.R', echo=TRUE)
source('./scripts/5-metrics/events.R', echo=TRUE)
source('./scripts/7-scrape-odds/updateOdds.R', echo=TRUE)
source('./scripts/8-append-odds/SherdogToBFO.R', echo=TRUE)
source('./scripts/9-various-tables/Current Stats.R', echo = TRUE)
source('./scripts/9-various-tables/Add Gender.R', echo = TRUE)
source('./scripts/7-scrape-odds/futureOdds.R', echo=TRUE)
source('./scripts/10-future-fights/futureFights.R', echo = TRUE)
library(tidyverse)
library(rlang)
source('~/GitHub/MMAscraper/Shiny App/MatchPredictor/scriptsForApp.R', echo=TRUE)
filtData <- filtfightsOdds %>%
select(Link1, Link2, Result2, Method, Date, Event, odds, r1b, r2b, Age1, Age2, ratIncrease1, ratIncrease2, ratIncrease1_3, ratIncrease2_3) %>%
filter(Result2 %in% c("win", "loss")) %>%
mutate(bet = 10,
winnings = ifelse(Result2 %in% c("NC", "draw"), 0, ifelse(odds>0,ifelse(Result2=="win", odds*bet/100, -bet),
ifelse(Result2=="win", -100/odds * bet, -bet))) %>%
round(2)
) %>%
arrange(desc(Date))
test <- filtfightsOdds %>%
rowwise() %>%
mutate(winper = line_to_per(odds),
oddsCheck = paste0("between(odds, ",per_to_line(winper+0.05) %>% round(0),", ",
per_to_line(winper-0.05) %>% round(0),")"),
ageCheck = paste0("between(Age1-Age2, ",round(Age1-Age2-1.5, 1),", ", round(Age1-Age2+1.5, 1),")"),
ratCheck = paste0("between(r1b-r2b, ",round(r1b-r2b-50, 0),", ", round(r1b-r2b+50, 0),")"),
dateCheck = paste0("Date < ", "'",Date,"'"),
trendCheck = paste0("between(ratIncrease1_3-ratIncrease2_3, ",round(ratIncrease1_3-ratIncrease2_3-50, 0),", ",
round(ratIncrease1_3-ratIncrease2_3+50, 0),")")
) %>%
arrange(match_id)
test %>% filter(year(Date)>=2018) %>% group_by(Org) %>% summarise(n())
test %>% filter(year(Date)>=2018) %>% group_by(Org) %>% summarise(n()/2) %>% View
test %>% filter(year(Date)>=2018) %>% group_by(Org=="UFC") %>% summarise(n()/2) %>% View
586/(586+647)
test %>% View
# rating, age diff
for (i in 1:nrow(test)) {
data <- filtData %>%
filter(eval_tidy(parse_expr(paste(test[i, 61:63] %>% as.character, collapse=" & ")))) %>%
summarise(avgWin = sum(winnings)/n(),
wins = sum(Result2=="win"),
count = n(),
winPerSimFight = ifelse(count==0, NA, wins/count),
ROI = round(sum(winnings)/(mean(bet)*n())*100, 2))
test$winPerSimFight3[i] <- data %>% pull(winPerSimFight)
test$ROI3[i] <- data %>% pull(ROI)
test$count3[i] <- data %>% pull(count)
message(i)
}
# rating, age, odds diff
for (i in 1:nrow(test)) {
data <- filtData %>%
filter(eval_tidy(parse_expr(paste(test[i, 60:63] %>% as.character, collapse=" & ")))) %>%
summarise(avgWin = sum(winnings)/n(),
wins = sum(Result2=="win"),
count = n(),
winPerSimFight = ifelse(count==0, NA, wins/count),
ROI = round(sum(winnings)/(mean(bet)*n())*100, 2))
test$winPerSimFight4[i] <- data %>% pull(winPerSimFight)
test$ROI4[i] <- data %>% pull(ROI)
test$count4[i] <- data %>% pull(count)
message(i)
}
test <- test %>%
mutate(bet = 10,  winnings = ifelse(Result %in% c("NC", "draw"), 0, ifelse(odds>0,ifelse(Result=="win", odds*bet/100, -bet),
ifelse(Result=="win", -100/odds * bet, -bet))) %>%
round(2)) %>%
ungroup()
test %>%
filter(Date >= '2015-01-01' & count3 > 50 & Result %in% c("win", "loss")) %>%
group_by(
(((ROI3>=3 | ROI4>=3) & odds>0) | (ROI3>=10 & odds<0)) &
ROI3 > -11) %>%
summarise(
fights = n(),
winnings = sum(winnings),
ROI = round(sum(winnings)/sum(bet)*100,2),
winper = sum(Result=="win")/n()
)
############### Find the best future fights to bet on
filtData2 <- futureFights %>%
select(Link1, Link2, Date, Event, odds, r1b, r2b, Age1, Age2, ratIncrease1, ratIncrease2, ratIncrease1_3, ratIncrease2_3) %>%
mutate(bet = 10,
potWinnings = ifelse(odds>0, odds*bet/100, -100/odds * bet) %>%
round(2)
)
test2 <- filtData2 %>%
rowwise() %>%
mutate(winper = line_to_per(odds),
oddsCheck = paste0("between(odds, ",per_to_line(winper+0.05) %>% round(0),", ",
per_to_line(winper-0.05) %>% round(0),")"),
ageCheck = paste0("between(Age1-Age2, ",round(Age1-Age2-1.5, 1),", ", round(Age1-Age2+1.5, 1),")"),
ratCheck = paste0("between(r1b-r2b, ",round(r1b-r2b-50, 0),", ", round(r1b-r2b+50, 0),")"),
trendCheck = paste0("between(ratIncrease1_3-ratIncrease2_3, ",round(ratIncrease1_3-ratIncrease2_3-50, 0),", ",
round(ratIncrease1_3-ratIncrease2_3+50, 0),")")
)
for (i in 1:nrow(test2)) {
data <- filtData %>%
filter(eval_tidy(parse_expr(paste(test2[i, 18:20] %>% as.character, collapse=" & ")))) %>%
summarise(avgWin = sum(winnings)/n(),
wins = sum(Result2=="win"),
count = n(),
winPerSimFight = ifelse(count==0, NA, wins/count),
ROI = round(sum(winnings)/(mean(bet)*n())*100, 2))
test2$winPerSimFight3[i] <- data %>% pull(winPerSimFight)
test2$ROI3[i] <- data %>% pull(ROI)
test2$count3[i] <- data %>% pull(count)
print(i)
}
for (i in 1:nrow(test2)) {
data <- filtData %>%
filter(eval_tidy(parse_expr(paste(test2[i, 17:20] %>% as.character, collapse=" & ")))) %>%
summarise(avgWin = sum(winnings)/n(),
wins = sum(Result2=="win"),
count = n(),
winPerSimFight = ifelse(count==0, NA, wins/count),
ROI = round(sum(winnings)/(mean(bet)*n())*100, 2))
test2$winPerSimFight4[i] <- data %>% pull(winPerSimFight)
test2$ROI4[i] <- data %>% pull(ROI)
test2$count4[i] <- data %>% pull(count)
print(i)
}
test2 %>%
filter((((ROI3>3 | ROI4>3) & odds>0) |(ROI3>10 & odds<0)) & ROI3 > -11,
year(Date) == 2019, count3 > 50) %>%
select(Link1, Link2, Date, Event, odds, r1b, r2b, Age1, Age2, bet, potWinnings, winper, ROI3, ROI4) %>%
View
test2 %>%
filter((((ROI3>3 | ROI4>3) & odds>0) |(ROI3>10 & odds<0)) & ROI3 > -11,
year(Date) == 2019, count3 > 50) %>%
select(Link1, Link2, Date, Event, odds, r1b, r2b, Age1, Age2, bet, potWinnings, winper, ROI3, ROI4) %>%
View
test2 %>%
filter((((ROI3>3 | ROI4>3) & odds>0) |(ROI3>10 & odds<0)) & ROI3 > -11, count3 > 50) %>%
select(Link1, Link2, Date, Event, odds, r1b, r2b, Age1, Age2, bet, potWinnings, winper, ROI3, ROI4) %>%
View
test %>%
filter(Date >= '2015-01-01' & count3 > 50 & Result %in% c("win", "loss")) %>%
group_by(
(((ROI3>=3 | ROI4>=3) & odds>0) | (ROI3>=10 & odds<0)) &
ROI3 > -11) %>%
summarise(
fights = n(),
winnings = sum(winnings),
ROI = round(sum(winnings)/sum(bet)*100,2),
winper = sum(Result=="win")/n()
)
test2 %>%
filter((((ROI3>3 | ROI4>3) & odds>0) |(ROI3>10 & odds<0)) & ROI3 > -11,
year(Date) == 2019, count3 > 50) %>%
select(Link1, Link2, Date, Event, odds, r1b, r2b, Age1, Age2, bet, potWinnings, winper, ROI3, ROI4) %>%
View
test2
test2 %>% View
names(test2)[17:20]
names(test2)[17:20]
test2 <- filtData2 %>%
rowwise() %>%
mutate(winper = line_to_per(odds),
oddsCheck = paste0("between(odds, ",per_to_line(winper+0.05) %>% round(0),", ",
per_to_line(winper-0.05) %>% round(0),")"),
ageCheck = paste0("between(Age1-Age2, ",round(Age1-Age2-1.5, 1),", ", round(Age1-Age2+1.5, 1),")"),
ratCheck = paste0("between(r1b-r2b, ",round(r1b-r2b-50, 0),", ", round(r1b-r2b+50, 0),")"),
trendCheck = paste0("between(ratIncrease1_3-ratIncrease2_3, ",round(ratIncrease1_3-ratIncrease2_3-50, 0),", ",
round(ratIncrease1_3-ratIncrease2_3+50, 0),")")
)
for (i in 1:nrow(test2)) {
data <- filtData %>%
filter(eval_tidy(parse_expr(paste(test2[i, 18:19] %>% as.character, collapse=" & ")))) %>%
summarise(avgWin = sum(winnings)/n(),
wins = sum(Result2=="win"),
count = n(),
winPerSimFight = ifelse(count==0, NA, wins/count),
ROI = round(sum(winnings)/(mean(bet)*n())*100, 2))
test2$winPerSimFight3[i] <- data %>% pull(winPerSimFight)
test2$ROI3[i] <- data %>% pull(ROI)
test2$count3[i] <- data %>% pull(count)
print(i)
}
for (i in 1:nrow(test2)) {
data <- filtData %>%
filter(eval_tidy(parse_expr(paste(test2[i, 17:19] %>% as.character, collapse=" & ")))) %>%
summarise(avgWin = sum(winnings)/n(),
wins = sum(Result2=="win"),
count = n(),
winPerSimFight = ifelse(count==0, NA, wins/count),
ROI = round(sum(winnings)/(mean(bet)*n())*100, 2))
test2$winPerSimFight4[i] <- data %>% pull(winPerSimFight)
test2$ROI4[i] <- data %>% pull(ROI)
test2$count4[i] <- data %>% pull(count)
print(i)
}
test2 %>%
filter((((ROI3>3 | ROI4>3) & odds>0) |(ROI3>10 & odds<0)) & ROI3 > -11,
year(Date) == 2019, count3 > 50) %>%
select(Link1, Link2, Date, Event, odds, r1b, r2b, Age1, Age2, bet, potWinnings, winper, ROI3, ROI4) %>%
View
runApp('Shiny App/MatchPredictor')
View(topFighters)
View(fightMetricsEventOdds)
View(topFighters)
runApp('Shiny App/MatchPredictor')
source('~/GitHub/MMAscraper/scripts/0-run-scripts/Update_Everything.R', echo=TRUE)
test
test %>% filter((((ROI3>=3 | ROI4>=3) & odds>0) | (ROI3>=10 & odds<0)) &
ROI3 > -11, year(Date) == 2019, count3 > 50) %>% View
test %>% filter((((ROI3>=3 | ROI4>=3) & odds>0) | (ROI3>=10 & odds<0)) &
ROI3 > -11, year(Date) == 2019, count3 > 50) %>%
arrange(desc(Date)) %>% View
test %>% filter((((ROI3>=3 | ROI4>=3) & odds>0) | (ROI3>=10 & odds<0)) &
ROI3 > -11, year(Date) == 2019, count3 > 50) %>%
arrange(desc(match_id)) %>% View
test2 %>%
filter((((ROI3>3 | ROI4>3) & odds>0) |(ROI3>10 & odds<0)) & ROI3 > -11,
year(Date) == 2019, count3 > 50) %>%
select(Link1, Link2, Date, Event, odds, r1b, r2b, Age1, Age2, bet, potWinnings, winper, ROI3, ROI4) %>%
View
source('./scripts/7-scrape-odds/futureOdds.R', echo=TRUE)
source('./scripts/10-future-fights/futureFights.R', echo = TRUE)
source('./scripts/9-various-tables/ROI-analyse.R', echo=TRUE)
test %>% filter((((ROI3>=3 | ROI4>=3) & odds>0) | (ROI3>=10 & odds<0)) &
ROI3 > -11, year(Date) == 2019, count3 > 50) %>%
arrange(desc(match_id)) %>% View
test %>%
filter(Date >= '2015-01-01' & count3 > 50 & Result %in% c("win", "loss")) %>%
group_by(
(((ROI3>=3 | ROI4>=3) & odds>0) | (ROI3>=10 & odds<0)) &
ROI3 > -11) %>%
summarise(
fights = n(),
winnings = sum(winnings),
ROI = round(sum(winnings)/sum(bet)*100,2),
winper = sum(Result=="win")/n()
)
test %>%
filter(Date >= '2015-01-01' & count3 > 50 & Result %in% c("win", "loss")) %>%
group_by(ROI4>20) %>%
summarise(
fights = n(),
winnings = sum(winnings),
ROI = round(sum(winnings)/sum(bet)*100,2),
winper = sum(Result=="win")/n()
)
test2 %>%
filter((((ROI3>3 | ROI4>3) & odds>0) |(ROI3>10 & odds<0)) & ROI3 > -11,
year(Date) == 2019, count3 > 50) %>%
select(Link1, Link2, Date, Event, odds, r1b, r2b, Age1, Age2, bet, potWinnings, winper, ROI3, ROI4) %>%
View
test %>%
filter(Date >= '2015-01-01' & count3 > 50 & Result %in% c("win", "loss")) %>%
group_by(ROI4>20 & ROI3 > 0) %>%
summarise(
fights = n(),
winnings = sum(winnings),
ROI = round(sum(winnings)/sum(bet)*100,2),
winper = sum(Result=="win")/n()
)
test2 %>%
filter((((ROI3>3 | ROI4>3) & odds>0) |(ROI3>10 & odds<0)) & ROI3 > -11,
year(Date) == 2019, count3 > 50) %>%
select(Link1, Link2, Date, Event, odds, r1b, r2b, Age1, Age2, bet, potWinnings, winper, count4, ROI3, ROI4) %>%
View
runApp('Shiny App/MatchPredictor')
test %>%
filter(Date >= '2015-01-01' & count3 > 50 & Result %in% c("win", "loss")) %>%
group_by(ROI4>20 & ROI3 > -8) %>%
summarise(
fights = n(),
winnings = sum(winnings),
ROI = round(sum(winnings)/sum(bet)*100,2),
winper = sum(Result=="win")/n()
)
test %>%
filter(Date >= '2015-01-01' & count3 > 50 & Result %in% c("win", "loss")) %>%
group_by(ROI4>10 & ROI3 > -8) %>%
summarise(
fights = n(),
winnings = sum(winnings),
ROI = round(sum(winnings)/sum(bet)*100,2),
winper = sum(Result=="win")/n()
)
test %>%
filter(Date >= '2015-01-01' & count3 > 50 & Result %in% c("win", "loss")) %>%
group_by(ROI4>0 & ROI3 > -8) %>%
summarise(
fights = n(),
winnings = sum(winnings),
ROI = round(sum(winnings)/sum(bet)*100,2),
winper = sum(Result=="win")/n()
)
test %>%
filter(Date >= '2015-01-01' & count3 > 50 & Result %in% c("win", "loss")) %>%
group_by(ROI4<0 & ROI3 > -8) %>%
summarise(
fights = n(),
winnings = sum(winnings),
ROI = round(sum(winnings)/sum(bet)*100,2),
winper = sum(Result=="win")/n()
)
View(fightMetricsEventOdds)
shiny::runApp('Shiny App/MatchPredictor')
runApp('Shiny App/MatchPredictor')
runApp('Shiny App/MatchPredictor')
shiny::runApp('Shiny App/MatchPredictor')
runApp('Shiny App/MatchPredictor')
library(shinysky)
library(shinyjs)
runApp('Shiny App/MatchPredictor')
if("tidyverse" %in% (.packages())){
detach("package:tidyverse", unload=TRUE)
}
library(shiny)
library(shinyjs)
library(shinysky)
library(plotly)
library(tidyverse)
library(DT)
# read datasets
futureFights <- readRDS("~/GitHub/MMAscraper/Shiny App/MatchPredictor/data/futureFights.RDS")
fightMetricsEventOdds <- readRDS("~/GitHub/MMAscraper/Shiny App/MatchPredictor/data/fightMetricsEventOdds.rds") %>%
mutate(Date = as.character(Date),
r1b = as.integer(r1b),
r2b = as.integer(r2b),
odds = as.integer(odds)) %>%
arrange(desc(match_id))
filtfightsOdds <- readRDS("~/GitHub/MMAscraper/Shiny App/MatchPredictor/data/filtfightsOdds.rds")
topFighters <- fightMetricsEventOdds %>%
group_by(Link1, Fighter1) %>%
arrange(desc(Date)) %>%
slice(1) %>%
select(Link1, Fighter1, r1a) %>%
arrange(desc(r1a)) %>%
head(5000)
# extra functions
with_plus <- function(x, ...) {
if (x > 0) {
return(sprintf(fmt = "+%s", format(x, ...)))
}
else {
return(x)
}
}
line_to_per <- function(x) {
return(if_else(x < 0, -x/((-x + 100)), 100/(x+100)))
}
per_to_line <- function(x) {
return(if_else(x <= 0.5, (1-x)/x * 100, x/(1-x) * -100))
}
odds_to_return <- function(x, bet=10) {
return(if_else(x < 0, bet/-x*100, x*bet/100))
}
######
graphFighters <- function(fighterNames, title=NULL, opponent=FALSE) {
Fighters <- fightMetricsEventOdds %>%
filter(Fighter1 %in% fighterNames) %>%
group_by(Link1, Fighter1) %>%
summarise(maxRat = max(r1a)) %>%
arrange(desc(maxRat)) %>%
group_by(Fighter1) %>%
slice(1) %>%
pull(Link1)
ggplot(fightMetricsEventOdds %>%
mutate(Date = as.Date(Date)) %>%
rename(Rating = r1a, Fighter = Fighter1, Opponent = r2b) %>%
filter(Link1 %in% Fighters),
aes(x = Date)) +
geom_line(aes(y=Rating, col=Fighter)) +
geom_point(aes(y=Rating, col=Fighter)) +
{if(opponent) geom_point(aes(y=Opponent, col=Fighter, shape = 1))} +
scale_shape_identity() +
scale_x_date(breaks = function(x) seq.Date(from=min(x), to=max(x), by="2 years"), date_labels = "%Y") +
xlab("Date") +
ylab("Elo Rating") +
ggtitle(title)
# test <<- fightMetricsEventOdds %>%
#   filter(Fighter1 %in% fighterNames)
}
runApp('Shiny App/MatchPredictor')
View(fightMetricsEventOdds)
